\documentclass[pra,
aps,
twocolumn,
superscriptaddress,
groupedaddress,
nofootinbib,
reprint
]{revtex4-1}

\input{preamble}

\begin{document}

\begin{abstract}
Magic states are essential for achieving universality in fault-tolerant schemes.
Magic resource theories attempt to quantify magic via monotones and thus describe the manipulation of magic states.
Here we introduce the concept of majorization fragments as a more generalised projection of such theories in discrete odd dimensions which allows for more powerful results than what monotones can provide.
Fragments naturally link the symmetries of a gate sequence with conditions on the convertibility between states.
We demonstrate the power of fragments by providing exact conditions for the convertibility of single-copy qutrit magic states as well as stricter distillation bounds than the established mana monotone in any odd dimension.
\end{abstract}

\preprint{APS/123-QED}

\title{Thermodynamic fragments in magic state theories}

\author{Nikolaos Koukoulekidis}
	\email{nk2314@imperial.ac.uk}
	\affiliation{Department of Physics, Imperial College London, London SW7 2AZ, UK}
\author{David Jennings}
	\affiliation{School of Physics and Astronomy, University of Leeds, Leeds, LS2 9JT, UK}
	\affiliation{Department of Physics, Imperial College London, London SW7 2AZ, UK}

\date{\today}
\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}
\label{sec:intro}

\begin{enumerate}
    \item Fault-tolerance~\cite{cit:raussendorf, cit:gross2, cit:markov, cit:gross, cit:nest, cit:nest2, cit:vidal, cit:fujii, cit:gottesman}
    \item Magic~\cite{cit:veitch, cit:veitch2, cit:wang, cit:wang2, cit:howard, cit:campbell, cit:gross3, cit:gross4}
    \item Bringing in majorization~\cite{cit:cwiklinski, cit:lostaglio2, cit:lostaglio, cit:gour, cit:janzing, cit:brandao2, cit:gour2, cit:marshall, cit:nielsen}
    \item Section breakdown
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Magic Resource Theories}
\label{sec:magic}

\subsection{Introduction}

Magic states are necessary for achieving universal quantum computation within fault-tolerant schemes.
Identifying magic as a resource for quantum universality has led to several theories which try to provide a framework for its quantification and manipulation \nick{CITE}.
The main question that such a theory attempts to answer is:
\begin{center}
    \emph{Given two magic states $\rho$ and $\rho'$ is there a free operation that can convert $\rho$ to $\rho'$?}
\end{center}

We are interested in all resource theories of magic $\R = (\F, \O)$ in which free operations cannot generate any amount of resource. 
Further denote by $\D$ the set of states considered under the theory, that is the union of free and resource states.
The structure of such theory is described by a partial order \nick{CITE}, hereinafter called a \emph{pre-order}, $\prec_{\R}$ between states.
We write $\rho' \prec_{\R} \rho$ iff there exists $\E \in \O$ such that $\E(\rho) = \rho'$.
Naturally, states may be incomparable under the given theory, meaning that there exists no free operation that converts one to the other.
We further call $\R' = (\F', \O')$ a \emph{subtheory} of $\R$ iff $\F' \subseteq \F$ and $\O' \subseteq \O$. 
The above notation will be used for general resource theories as well.

Formally, the no resource generation condition on the theories translates into two assumptions:
\begin{enumerate}[I]
    \item Free operations send free states into free states, $\E: \F \mapsto \F$, for all $\E \in \O$;
    \item Resource theory $\R$ is a completely free state preserving theory, in the sense that for any $d$-dimensional ancilla system and all free operations $\E$, $(\id_d \otimes \E ) \sigma \in \F$ whenever $\sigma \in \F$.
\end{enumerate}
The first assumption simply states that resources cannot be generated for free and is a minimal requirement for a resource theory. 
An immediate consequence is that if statistical mixing is included in $\O$, then the resource theory is convex.
Convex resource theories have attracted a lot of attention recently \nick{CITE} and include the magic theories discussed in~\cref{sec:prev}.
The second assumption implies that resources cannot be generated even when ancillas are allowed \nick{example of T state generation on Bell state by Campbell}.

Monotones are often used \nick{CITE} to address the question of state convertibility, although such approaches are usually generic.
A monotone of any general resource theory is a projection of the theory onto the non-negative real numbers, collapsing the pre-order of the theory to the total order defined on the real line.
This is the \nick{most naive} non-trivial projection under which the images of incomparable states can be compared.
Our first contribution is the introduction of a generalised notion of \emph{resource projection} which maps a general resource theory onto a subtheory which in principle still retains a partial structure.
Applying this notion on existing magic theories highlights the hidden stochasticity that governs magic state conversions.
We show that a magic theory can be subdivided into \emph{fragments} \nick{expand}

\subsection{Previous work}\label{sec:prev}

The stabilizer theory \nick{CITE} is the first theory to introduce the idea of magic and it is discussed in sufficient detail for our purposes in~\cref{sec:so}. 
It comprises of the so-called ``stabilizer'' states ($\stab$) and operations ($\so$), while non-stabilizer (resource) states are called magic.
The stabilizer operations can be expressed in terms of a Stinespring dilation as 
\begin{equation}
    \E(\rho) = \tr_E [U(\rho \otimes \sigma_E)U^\dagger],
\end{equation} 
for an ancilla stabilizer state $\sigma_E$. 
The motivation of the theory stems from the fact that stabilizer operations are experimentally straightforward to implement and they can be used to detect and correct errors on the stabilizer states due to their construction \nick{CITE}.
The Gottesman-Knill theorem however indicates that stabilizer operations need to be supplemented with magic states in order to achieve universality, justifying the term ``magic''.

Generalisations of the stabilizer theory appear in the literature intending to include broader classes of operations \nick{CITE}.
The class of stabilizer preserving operations ($\spo$) is defined as the set of $\cptp$ maps that send stabilizer states into stabilizer states~\cite{cit:ahmadi}.
An important subclass of $\spo$ is the set of completely stabilizer preserving operations ($\cspo$), which intuitively cannot induce ``non-stabilizerness'' even when applied to only part of a quantum state, i.e. operations $\E$ such that $(\id_d \otimes \E ) \sigma \in \stab$ for all positive dimensions $d$ whenever $\sigma \in \stab$.

Even though non-stabilizerness is a necessary resource for universality, it has been proven insufficient for magic state distillation~\cite{cit:bravyi, cit:campbell}.
In fact, all states with non-negative Wigner distributions have been proven to be efficiently classically simulable in~\cite{cit:mari}, a result that serves as a generalization of the Gottesman-Knill theorem.
The Wigner distribution of a state in odd prime dimensions is discussed rigorously in~\cref{sec:wigner} and arises as the unique quasi-probability representation of quantum theory that identifies non-contextuality exactly with the states that are efficiently classically simulable~\cite{cit:howard2, cit:veitch2}.
In this framework, the stabilizer states are the only pure states represented with non-negative distributions~\cite{cit:gross3}. 
However, there exist mixed states with non-negative Wigner distributions that are not mixtures of stabilizer states~\cite{cit:gross}.
Therefore, stabilizer-preserving theories have been extended to a theory that preserves state ``Wigner positivity''~\cite{cit:wang}, formally defined in~\cref{sec:wigner} for odd prime dimensions.
Informally, it can be considered as the maximal theory of magic $\Rmax = (\Fmax, \Omax)$, where free states have non-negative Wigner distributions and free operations completely preserve this property.

\ddd{Things we must emphasize:
\begin{enumerate}
\item Perhaps a nice lead-in question: ``What happens if we view stabilizer states as thermodynamic equilibrium states and magic as a form of free energy?''
\item We can tackle more `physicsy' questions like: how much magic can be distilled via free operations with some given fixed-point structure? E.g. 
\item This allows a diagnostic on the kind of operations needed to do good distillation. I.e. what fixed point structure should they have?
\item We go beyond magic monotones and replace a monotone with a $\sigma$-fragment.
\item We can get both upper and lower bounds on magic distillation.
\end{enumerate}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Phase Space formalism}
\label{sec:ps}

\subsection{Stabilizer Theory}\label{sec:so}

Let $\{\ket{k}\}_{k \in \zd}$ be the standard computational basis for an arbitrary fault-tolerant scheme, defined over the finite field $\zd = \{ 0, 1, \dots,d-1 \}$, with $d$ an odd prime. 
Since the field has character $d$, addition and multiplication on the field are always considered modulo $d$.
The Hilbert space of any system associated with this scheme is $\hd \coloneqq \spanv{\ket{k}: k \in \zd}$.

The generalised Pauli matrices $X, Z$ can be defined by their respective roles as shift and phase operators,
\begin{align}
    X \ket{k} &= \ket{k + 1} \label{eq:xpauli}\\
	Z \ket{k} &= \omega^k \ket{k}, \label{eq:zpauli}
\end{align}
where $\omega \coloneqq e^{2\pi i/d}$ is the $d$-th root of unity. 

The Hilbert space $\hd$ is associated with a phase space $\pd \coloneqq \zd \times \zd$, where every point $\bmx \coloneqq (x_0, x_1)$ corresponds to a displacement operator, defined as
\begin{equation}\label{eq:ddef}
    D_{\bmx} \coloneqq \tau^{x_0 x_1} X^{x_0} Z^{x_1},\ \bmx  \in \pd.
\end{equation}
The phase factor $\tau \coloneqq -\omega^{1/2}$ ensures unitarity.
For a system with composite Hilbert space, $\hd = \hd[d_A] \otimes \hd[d_B]$, the displacement operators are defined as
\begin{equation}\label{eq:composited}
    D_{\bmx_A \oplus \bmx_B} \coloneqq D_{\bmx_A} \otimes D_{\bmx_B},
\end{equation}
where $\bmx_A \oplus \bmx_B \coloneqq (x_{A0}, x_{B0}, x_{A1}, x_{B1}) \in \pd[d_A] \times \pd[d_B]$.

The displacement operators, form a group under matrix multiplication modulo phases,
\begin{equation}\label{eq:gp}
    \gp \coloneqq \{ \tau^k D_{\bmz}: k \in \zd, \bmz \in \pd\}.
\end{equation}
The Clifford unitaries $\cd$ can then be defined as the normaliser of this group, \nick{Reformulate for copies of qudits: $\gp,\ \cd \rightarrow \gp^n,\ \cd^n$. $C-SUM$s live in $\cd^2$}
\begin{equation}
    \cd \coloneqq \{ U \in {\rm{SU}}(d): U\gp U^\dagger = \gp \}.
\end{equation}
The pure stabilizer states are then the orbit of the Clifford unitaries over a computational basis state,
\begin{equation}\label{eq:stab}
    \stab_{{\rm{pure}}} \coloneqq \{ U\ketbra{0}{0}U^\dagger: U \in \cd \}.
\end{equation}

The free states of the stabilizer theory are mixtures of pure stabilizers, 
\begin{equation}
    \stab = \conv\ \stab_{{\rm{pure}}}.
\end{equation}
The free operations of the stabilizer theory is the set of stabilizer operations $\so$ defined as any composition of:
\begin{enumerate}
    \item Preparation in computational basis;
    \item Random Clifford unitaries $\rcu$, i.e. operations $\E$ such that 
    \begin{equation}
        \E(\rho) = \sum_i p_i U_i \rho U_i^\dagger,\ U_i \in \cd;
\end{equation}
    \item Measurement in computational basis.
\end{enumerate}

\subsection{Wigner Distribution}\label{sec:wigner}

We can define the phase-point operators,
\begin{align}
	A_{\bmx} \coloneqq \frac{1}{d} \sum_{\bmz \in \pd} \omega^{\bmx \wedge \bmz} D_{\bmz},\ \bmx \in \pd. \label{eq:ax}
\end{align}
\nick{$\wedge$ has not be defined} They form an orthogonal Hermitian operator basis.
Therefore, any quantum state $\rho \in \cal{B}(\hd)$ can be expressed as a linear combination of the phase-point operators,
\begin{equation}
    \rho = \sum_{\bmz \in \pd} \W[\bmz]{\rho} A_{\bmz},
\end{equation}
where the coefficient vector $\W{\rho}$ is the Wigner distribution of state $\rho$,
\begin{equation}\label{eq:wstate}
    \W[\bmx]{\rho} \coloneqq \frac{1}{d}\tr[A_{\bmx} \rho].
\end{equation}
It is in fact a real, bounded, $d^2$-dimensional quasi-probability distribution over $\pd$ as shown in~\cref{app:wigner}. 

The Wigner distributions of different types of qutrit states are illustrated in~\cref{fig:wstate_examples}.
\begin{figure}%
    \centering
    \subfigure[][]{%
    \label{fig:maxmix}%
    \includegraphics[height=2cm]{figs/maxmixed.pdf}
    %\caption{Maximally mixed state $\frac{1}{3}\id$}%
    }\hspace{8pt}%
    \subfigure[][]{%
    \label{fig:zero}%
    \includegraphics[height=2cm]{figs/zerostate.pdf}
    %\caption{Zero state $\ketbra{0}{0}$}%
    }\\
    \subfigure[][]{%
    \label{fig:bound}%
    \includegraphics[height=2cm]{figs/boundstate.pdf}
    %\caption{Bound state}%
    }\hspace{8pt}%
    \subfigure[][]{%
    \label{fig:strange}%
    \includegraphics[height=2cm]{figs/strangestate.pdf}
    %\caption{Strange state $\ketbra{S}{S}$}%
    }
    \caption{\textbf{Qutrit Wigner distributions of varying magic.} 
    \subref{fig:maxmix} Maximally mixed state $\frac{1}{3}\id$; \subref{fig:zero} Stabilizer zero state $\ketbra{0}{0}$; \subref{fig:bound} A non-stabilizer Wigner-positive state; \subref{fig:strange} Magic strange state $\ket{{\rm{S}}} = \frac{1}{\sqrt{2}}(\ket{1} - \ket{2})$ \nick{CITE}.
    \nick{Explain what a magic / bound magic state is in intro}
    }%
    \label{fig:wstate_examples}
\end{figure}

We can exploit the channel-state duality and use the normalised Choi-Jamio\l{}kowski state 
\begin{equation}\label{eq:cj}
    \frac{1}{d_A}\J(\E) \coloneqq \frac{1}{d_A}(\id \otimes \E) \sum_{i,j} \ket{ii}\bra{jj}
\end{equation}
to extend the definition of the Wigner distribution to quantum $\cptp$ operations $\E: \cal{B}(\hd[d_A]) \mapsto \cal{B}(\hd[d_B])$, 
\begin{align}\label{eq:woperation}
    \W[\bmy|\bmx]{\E} 
    &\coloneqq d_A^2 \W[\bm{\bar x} \oplus \bmy]{\frac{1}{d_A}\J(\E)} \\
    &= \frac{1}{d_B} \tr_B[A_{\bmy} \E(A_{\bmx})],
\end{align}
where $\bm{\bar x} \coloneqq (x_0, -x_1)$.

The specific form of~\cref{eq:woperation} is chosen so that Wigner distributions of operations act as transition matrices for Wigner distributions of states, $\W{\E(\rho)} = \W{\E}\W{\rho}$.
In particular, $\cptp$ operations that map between density operators of equal dimensions and have non-negative Wigner distributions correspond to stochastic matrices, as shown in~\cref{app:wigner}

The single-qudit Hadamard gate $H$ and phase gate $S$ generate the $d$-dimensional Clifford group $\cd$. \nick{CITE}
Their Wigner distributions are given by permutation matrices,
\begin{align}
    H &\coloneqq \frac{1}{\sqrt{d}}\sum_{j,k} \omega^{jk} \ketbra{j}{k}, \W[\bmy|\bmx]{H} = \delta_{y_0, -x_1}\delta_{y_1, x_0};\label{eq:H}\\
    S &\coloneqq \sum_k \tau^{k(k+1)} \ketbra{k}{k}, \W[\bmy|\bmx]{S} = \delta_{y_0, x_0}\delta_{y_1, x_0 + x_1 + 2^{-1}}.\label{eq:S}
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Stochastic structure of magic theories}
\label{sec:struc}

\subsection{Magic fragments}\label{sec:magfrag}

Equipped with the definitions of the Wigner distribution in odd prime dimensions, we can formally recast the maximal magic theory $\Rmax$ into a stochasticity setting.
The free states correspond to proper probability distributions 
\begin{equation}
    \Fmax \coloneqq \{ \rho: \W[\bmz]{\rho} \geq 0 \text{ for all } \bmz \in \pd\}
\end{equation}

The free operations should send the set of free states $\Fmax$ into itself and completely preserve the non-negativity of the states, in the sense that $\E \in \Omax$ iff $(\id_d \otimes \E ) \sigma \in \stab$ for all odd prime dimensions $d$ whenever $\sigma \in \Fmax$.
It is shown by Wang \textit{et al.}~\cite{cit:wang} that $\Omax$ coincides with the set of operations $\E$ that correspond to stochastic Wigner distributions, 
\begin{equation}
    \Omax = \{ \E: \W[\bmy|\bmx]{\E} \geq 0 \text{ for all } \bmx, \bmy \in \pd\}.
\end{equation}

Any magic theory $\R = (\F, \O)$ is a subtheory of $\Rmax$ as explained in~\cref{sec:intro}, and as such it falls under this new stochasticity setting. 
For technical simplicity in what follows we assume that $\F$ is a closed set, and note that $\F_{\rm{ max}}$ is itself a closed set, since it is specified by a finite set of linear constraints of the form $\tr[ L\rho] \geq 0$ with operators $L \in \cal{B}(\cal{H})$ ensuring that the state is positive and Wigner-positive.


Given this context we now define the following key notion, that is central to our analysis.
\begin{definition}[\textbf{$\boldsymbol\sigma$-fragment}]\label{def:sigmafrag}
   Given a resource theory of magic $\R = (\F, \O)$, the \emph{$\sigma$--fragment of $\R$} is the resource theory $\R_\sigma = (\F, \O_\sigma)$, where the free operations are restricted to the ones that leave $\sigma$ invariant, namely
    \begin{equation}
        \O_\sigma \coloneqq \{ \E \in \O: \E(\sigma) = \sigma \}.
    \end{equation}
\end{definition}

With this basic notion defined, we now show that any resource theory of magic can be faithfully subdivided into $\sigma$--fragments, in such a way that any problem of interconversion in the parent magic theory $\R$ can be analysed across the different fragments.

\begin{theorem}
    Let $\R = (\F, \O)$ be a theory of magic.
    Every operation in $\O$ leaves at least one free state invariant,
  \begin{equation}
\O = \bigcup\limits_{\sigma \in \F} \O_\sigma.
\end{equation}
Therefore, $\rho \longrightarrow \tau$ in $\R$ if and only if $\rho \longrightarrow \tau$ in a $\sigma$--fragment of $\R$.
\end{theorem}
\begin{proof}
    Suppose $\E$ is in a $\sigma$--fragment $\O_\sigma$.
    Then it is also in $\O$, hence $\bigcup\limits_{\sigma \in \F} \O_\sigma \subseteq \O$. 
    
    Conversely, suppose $\E$ is in $\O$. 
    The free states are a closed set that is mapped one-to-one to a closed subset $\cal{S}$ of the $(d^2 - 1)$-dimensional probability simplex.
    $\cal{S}$ is convex, since any combination of free states is also free and the Wigner distribution is linear.
    Therefore, $\cal{S}$ is convex and compact as a closed convex subset of the bounded compact probability simplex.
    
    We can now view $\W{\E}$ as a stochastic, continuous mapping from $\cal{S}$ to itself, thus Brouwer's fixed point theorem \nick{CITE} implies that there exists a probability distribution $d_{\bmz}$ for some $ \bmz \in \pd$ that is a fixed point of $\W{\E}$.
    This corresponds to a free state $\sigma \coloneqq \sum_{\bmz \in \pd} d_{\bmz} A_{\bmz} \in \F$. 
    Therefore $\E \in \O_\sigma$, and so $\O = \bigcup\limits_{\sigma \in \F} \O_\sigma$. 
    
    The state interconversion result follows immediately.
\end{proof}

The zoo of all magic operation classes is summarised in ~\cref{fig:zoo}.
Completely positive-Wigner-preserving operations~\cite{cit:wang} form the operation class $\Omax$.
Therefore, $\sigma$--fragments cover this theory of magic exactly and any magic subtheory is contained within this cover.
In particular, the stabilizer operations $\so$ are contained within $\Omax$.
\begin{figure}[t]
    \centering
        \includegraphics[scale=0.47
        ]{figs/operations.pdf}
    \caption{\textbf{Decomposition of a magic theory $\R$ intro $\sigma$--fragments.} 
	Examples of magic theories ($\so$: Stabilizer operations, $\Omax$: Completely positive-Wigner-preserving operations, $\rcu$: Random Clifford Unitaries -- subclass of $\so$) involve operations denoted by the two yellow regions, with every other established magic theory  between them.
    We introduce $\sigma$--fragments $\O_\sigma$ defined for all free states $\sigma$ that cover $\Omax$. 
    Each $\O_\sigma$ is extensible to a set of stochastic maps outside the $\cptp$ operations.
    Within each $\sigma$--fragment $\bmd$-majorization can be used allowing for an intricate, but tractable approach towards the study of magic state interconversion.
    }
    \label{fig:zoo}
\end{figure}

The subdivision of magic theories into $\sigma$--fragments is powerful because the pre-order $\prec_{\R_\sigma}$ of every $\sigma$--fragment is described by well-behaved majorization tools, as we establish in~\cref{sec:major}.

\subsection{Majorization of quasi-probabilities in $\sigma$--fragments}\label{sec:major}

Majorization is a collection of powerful tools that has recently found many applications in quantum information theory \nick{CITE}.
It can describes the \nick{disorder / non-uniformity} of distributions that undergo stochastic transformations.

To formally state majorization results, we first denote by $\stoch$ the set of $(d \times d)$ stochastic matrices that preserve the probability vector $\bmd$. \nick{Should we introduce notation directly in the magic setting?}
Specifically, for any $S \in \stoch$, all matrix elements are non-negative, all rows sum to $1$ and $S\bmd = \bmd$.
\iffalse
\begin{enumerate}
    \item $S_{ij} \geq 0$ for all $i, j \in \zd$;
    \item $\sum\limits_{j=1}^n S_{ij} = 1$ for all $i \in \zd$;
    \item $S\bmd = \bmd$.
\end{enumerate}
\fi
The set $\stoch$ forms a group under matrix multiplication for all $\bmd$ with positive components.

Majorization finds an important application on quantum thermodynamics in the absence of coherence.
The use of majorization in this setting provides useful intuition for our purposes.
At any given temperature $\beta$, the thermal state $\gamma_\beta$ is thermodynamically the most disordered state. 
Thermal operations are defined as operations that cannot extract energy from the Gibbs state, $\E(\gamma_\beta) = \gamma_\beta$.
Convertibility between states via thermal operations is equivalent to a stochasticity condition on the energy level populations of the states \nick{CITE}.
Roughly, the statement is that there exists a thermal operation $\E$ such that $\tau = \E(\rho)$ if and only if there exists a a matrix $S \in \stoch$ such that $\bm{q} = S\bm{p}$, where $\bm{q}, \bm{p}$ and $\bmd$ and the energy level population vectors of $\tau, \rho, \gamma_\beta$ respectively.

Drawing intuition from this setting, we can define majorization as follows.
\begin{definition}[\textbf{$\boldsymbol\bmd$-majorization}]\label{def:dmajor}
    Given $\bmx, \bmy, \bmd \in \reals^d$, such that the components of $\bmd$ are positive, $\bmy$ is said to $\bmd$-majorize $\bmx$, iff there exists a matrix $S \in \stoch$ such that $\bmx = S\bmy$.
\end{definition}
We denote this pre-order by $\bmx \prec_{\bmd} \bmy$.
If $\bmd = \frac{1}{d}\bm{1}$, the $d$-dimensional uniform distribution, then $\stoch$ is the set of doubly stochastic matrices and we retrieve the familiar notion of majorization in entanglement theory. \nick{CITE}

The pre-order $\prec_{\R_\sigma}$ of the $\sigma$--fragment $\R_\sigma = (\F, \O_\sigma)$ between $d$-dimensional states corresponds to the majorization pre-order $\prec_{\W{\sigma}}$ between their $d^2$-dimensional Wigner distributions.
For simplicity we shall merge the notation into $\prec_\sigma$, as there is little risk of confusion.


\begin{theorem}\label{thm:sigmamajor}
    Let $\R = (\F, \O)$ be a theory of magic. Then $\rho \longrightarrow \tau$ is possible iff  $\W{\tau} \prec_\sigma \W{\rho}$ within a $\sigma$--fragment.
    \nick{I understand that dropping the full-rank assumption on $\sigma$ makes the statement a lot stronger, but also incorrect e.g. in the case of the replacement channel $\E(\rho) = \ketbra{0}$, since $d$-majorization in $\O_{\ketbra{0}}$ is not well-defined.}
\end{theorem}
\begin{proof}
Suppose we can convert $\rho$ into $\tau$ in the magic theory. 
Thus there is some $\O_\sigma$ and some $\E \in \O_\sigma$ such that $\E(\rho) = \tau$, and $\E(\sigma)=\sigma$. 
Therefore, the Wigner distribution of this free operation satisfies $\W{\E} \in \stochw$ and $\W{\E}\W{\rho} = \W{\tau}$. 
Since $\sigma$ is full-rank and free, its Wigner distribution is strictly positive in all components, so it directly follows from~\cref{def:dmajor} that $\W{\tau} \prec_{\sigma} \W{\rho}$.
\end{proof}
This result can be understood as an extension of the idea of a magic monotone, where we replace $\M(\tau) \leq \M(\rho)$ with $\W{\tau} \prec_\sigma \W{\rho}$. 
However the majorization constraints can be used to place upper bounds on magic state distillation in a way that allows one to incorporate the physics of the allowed operations -- this enables us to bound how much magic can be distilled via quantum operations that, for example, preserve the equilibrium state of the system, or via operations that are symmetric about the $Z$-axis of the Bloch sphere.

This approach can also provide \emph{lower bounds} on distillation, however now more structure about the specific free operations must be included. 
\nick{This is more involved and we discuss this later in the paper.
Also mention relative majorization somewhere}

\subsection{Majorization computations in $\sigma$--fragments}
A numerically efficient reformulation of $\bmd$-majorization is provided by Lorenz curves.
Let the vector $\bmu^\downarrow$ denote the vector $\bmu \in \reals^d$ with its components arranged in non-increasing order.
\begin{definition}[\textbf{Lorenz curve}]\label{def:lc}
    Let $\bmz, \bmd \in \reals^d$, where the components of $\bmd$ are positive with $D = \sum_{i=1}^d d_i$ and denote by $\tilde{\bmz} \coloneqq (z_1/d_1, \dots, z_d/d_d)^T$ the vector of ratios between the corresponding components of $\bmz$ and $\bmd$.
    
    Finally, denote by $\pi: \zd \mapsto \zd$ the permutation that sorts $\tilde{\bmz}$, $(\tilde{\bmz}^\downarrow)_i = z_{\pi(i)}$ for all $i=1,\dots,d$.
    
    Consider the piecewise linear curve obtained by joining the points $\{(0,0)\} \cup \{ (x_k, \lc{\bmz}{\bmd}(k)) \}_{k=1,\dots,d}$, where
    \begin{equation}\label{eq:lorenz}
        (x_k, \lc{\bmz}{\bmd}(k)) \coloneqq \left( \frac{1}{D}\sum_{i=1}^k d_{\pi(i)}, \sum_{i=1}^k z_{\pi(i)} \right) \in \mathbb{R}^2.
    \end{equation}
    We define the set of points on this curve, $\lc{\bmz}{\bmd}(x),\ x \in [0,1]$, as the \emph{Lorenz curve} of vector $\bmz$ with respect to $\bmd$.
\end{definition}
Components $x_k$ are rescaled by $D$ so that comparison of curves with unequal dimensions is possible.
In fact, the Lorenz curves $\lc{\bmz}{\bmd}$ and $\lc{\bmz \otimes \bmd}{\bmd \otimes \bmd}$, where $\otimes$ denotes the Kronecker product, are identical.
Furthermore, a Lorenz curve $\lc{\bmz}{\bmd}(x)$ is always concave in $x$, since it consists of $d$ line segments each with slope $(\tilde{\bmz}^\downarrow)_i$ for $i=1,\dots,d$ which is non-increasing by definition.

A vector $\bmy$ \emph{$\bmd$--majorizes} another vector $\bmx$ if and only if the Lorenz curve $\lc{\bmy}{\bmd}$ lies above Lorenz curve $\lc{\bmx}{\bmd}$, thus reducing $\bmd$--majorization into a finite set of inequalities.
\begin{theorem}\label{thm:dmajor}
    Let $\bmx, \bmy, \bmd \in \reals^d$, such that the components of $\bmd$ are positive. 
    Then, $\bmx \prec_{\bmd} \bmy$ if and only if $\lc{\bmx}{\bmd}(x) \leq \lc{\bmy}{\bmd}(x)$ for all $x \in [0,1]$ with strict equality at $x=1$.
\end{theorem}
A restatement of the theorem including more equivalent conditions and a proof are provided in~\cref{app:major}.
An example of comparison between different Lorenz curves is illustrated in~\cref{fig:lctoy}.
\begin{figure}
    \centering
    \includegraphics[height=5cm]{figs/lctoy.pdf}
    \caption{Example of different Lorenz curves for quasi-probability vectors under $\bmd$-majorization.
    Vectors $\bmy$ and $\bmd$ are simply probability distributions.
    The curve corresponding to vector $\bmd$ is always the line segment connecting $(0,0)$ and $(1,1)$, so that any other Lorenz curve lies above it, for example $\bmx \prec_{\bmd} \bmd$.
    Curves $L_k(\bmx|\bmd)$ and $L_k(\bmy|\bmd)$ intersect, so $\bmx \nprec_{\bmd} \bmy$ as well as $\bmy \nprec_{\bmd} \bmx$.
    \nick{Recast in terms of magic - replace with~\cref{fig:test}?}
    }
    \label{fig:lctoy}
\end{figure}

It is now straightforward to construct Lorenz curves for Wigner distributions in any $\sigma$--fragment.
As we have seen in~\cref{thm:sigmamajor}, for any full-rank free state $\sigma$ we have that $\W{\sigma}$ is a strictly positive full-rank probability distribution, and so one can define a corresponding notion of $d$--majorization on \emph{quasi}--distributions.
We write $\lc{\rho}{\sigma}(x)$ for the Lorenz curve of $\W{\rho}$ with respect to $\W{\sigma}$.

We now establish important properties of Lorenz curves that are independent of the $\sigma$--fragment they are defined in.
\begin{proposition}\label{thm:lccont}
	The Lorenz curve $\lc{\rho}{\sigma}(x)$ of a state $\rho$ with respect to state $\sigma$ is uniformly continuous in $\sigma$. 
	\nick{In the sense that if $\sigma$ and $\sigma'$ are $\delta$-close with respect to a state norm, then the curves $\lc{\rho}{\sigma}(x)$ and $\lc{\rho}{\sigma'}(x)$ are $\epsilon$-close at all $x \in [0,1]$.
	I think this clears up the narrative quite a bit? - Should we keep and prove this result?} \ddd{[Is a nice result...hmm let's wait and see. It might distract from the main message.]}
\end{proposition}
The proof of this important result is in \nick{the appendix}.
The consequence of this statement is that infinitesimal changes in state $\sigma$ only result in infinitesimal shifts of the $\sigma$--fragment.
Therefore, Lorenz curves and majorization analysis in general \nick{behave nicely in the presence of / are robust under} imperfections in the experimental implementation of quantum operations.
In particular, any $\sigma_0$--fragment defined by a non full-rank state $\sigma_0$ can be approximated by a $\sigma$--fragment defined by a full-rank $\sigma$ which is arbitrarily close to $\sigma_0$, such that $\sigma = (1-\epsilon)\sigma_0 + \epsilon\frac{1}{d}\id$, for some small $\epsilon > 0$.
Such $\sigma_0$--fragments may include important stabilizer operations such that the replacement channel defined as $\E(\rho) = \sigma_0$ for all states $\rho$.
For simplicity, we restrict analysis to $\sigma$-fragments, where $\sigma$ is full-rank.

Normalisation of the Wigner distribution \nick{REF} ensures that for all quantum states $\rho$, $\lc{\rho}{\sigma}(x) \geq 0$ and $\lc{\rho}{\sigma}(1) = 1$.
As a consequence, checking whether a state conversion $\rho \longrightarrow \tau$ is possible as per~\cref{thm:dmajor}, reduces to the condition $\lc{\rho}{\sigma}(x) \leq \lc{\tau}{\sigma}(x)$ for all $x \in [0,1]$.
We stress that $0 \leq \lc{\rho}{\sigma}(x) \leq 1$ for all $x \in [0,1]$ if and only if $\rho$ is a positive Wigner state.

The area $\A_\sigma(\rho)$ between the curve $L_{\rho|\sigma}$ and the line $y=1$ is a resource monotone in the $\sigma$--fragment. 
This is clear because for any state conversion $\rho \longrightarrow \tau$ for some $\E \in \O_\sigma$, the Lorenz curve $L_{\tau|\sigma}$ is lower than $L_{\rho|\sigma}$, hence $\A_\sigma(\E(\rho)) \leq \A_\sigma(\rho)$.
The exact form of the monotone is given in~\cref{app:areamono}

\ddd{[relate to mana?]} \nick{the area depends on several positive Wigner components and cannot be written as a function of mana annoyingly - should we include the area? Have a look at~\cref{app:areamono}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Magic state interconversion and Lorenz curves}
\label{sec:distill}

Any quantum circuit aiming at a given magic state conversion $\rho \longrightarrow \tau$ possesses certain symmetries according to~\cref{thm:frag} that allow us to study the conversion within only certain $\sigma$-fragments.
As a simple example, the dephasing channel
\begin{equation}\label{eq:dephase}
	\Delta(\rho) = \sum_{k \in \zd} \ketbra{k}{k}\rho\ketbra{k}{k}
\end{equation}
removes coherent phases in the computational basis and therefore leaves exactly all mixtures of computational basis states invariant.
A model circuit consisting only of such dephasing channels can be fully analysed in the $\sigma$--fragments for the pure computational basis states $\sigma$ \nick{as seen in a theorem in the appendix}.

Lorenz curves provide an efficient method of numerically checking if a certain state conversion is impossible within a $\sigma$--fragment by exploiting the equivalence with $d$--majorization stated in~\cref{thm:dmajor}.
Such methods are often more conclusive than magic monotones as we discuss in section~\cref{sec:scmana}.

\subsection{Mana and majorization in magic theories}\label{sec:scmana}
We now discuss majorization features common to all fragments, before specialising to particular $\sigma$--fragments and how analysis in them proceeds. 
Mana is the fundamental resource monotone for magic. 
Here we show that its properties are in fact special cases of more general majorization features. 
More precisely, its properties can be viewed as majorization-based, and independent of the particular $\sigma$--fragment one works in.

As discussed above, we know that every magic interconversion problem can be analysed across all $\sigma$--fragments that reflect symmetries of the circuit and moreover the pre-order in each such fragment is exactly specified by $d$--majorization.

Consider a general magic state interconversion in $\O_\sigma$, $\rho \xrightarrow{\E \in \O_\sigma} \tau$.
It is shown in~\cref{app:major} that mana is an additive monotone in every $\sigma$--fragment under $d$--majorization, so it provides a necessary condition for the process to be possible,
\begin{equation}\label{eq:manabound}
    \mana{\rho} \geq \mana{\tau}. %{\rm{C}}_{\rm{mana}}(\rho, \tau, \sigma):\ 
\end{equation}
A new bound can be obtained in the $\sigma$--fragment by comparing the Lorenz curves of the initial and target states,
\begin{equation}\label{eq:majbound}
    \lc{\rho}{\sigma}(x) \geq \lc{\tau}{\sigma}(x),\ x\in [0,1].
\end{equation}
If one of these consitions is not satisfied, then the Lorenz curve of initial state $\rho$ is below the curve of target $\tau$ at some point $x$ and the conversion is not possible.

In fact, our current setting makes it apparent that the mana condition is always weaker than the majorization condition for all magic state interconversions.

We first show that the maximum of $\lc{\rho}{\sigma}$ is independent of the $\sigma$--fragment and directly related to the state sum-negativity $\sn{\rho}$ discussed in~\cref{sec:mono}
\begin{lemma}\label{lem:lcmax}
	Given a quantum state $\rho$, the maximum of its Lorenz curve $\lc{\rho}{\sigma}$ is independent of the $\sigma$--fragment in which it is defined and equal to $1+\sn{\rho}$.
\end{lemma}
\begin{proof}
	For notational simplicity, denote $(\W{\rho})_i = \W[\bmx]{\rho},\ i = 1,\dots, d^2$ and similarly for $\W{\sigma}$.
	We choose the index mapping so that the vector of component ratios, 
	\begin{equation}
		\tilde{\bm{w}} \coloneqq \left(\frac{(\W{\rho})_1}{(\W{\sigma})_1}, \dots, \frac{(\W{\rho})_{d^2}}{(\W{\sigma})_{d^2}} \right)^T,
	\end{equation}
	is sorted in the sense that $\tilde{\bm{w}} = \tilde{\bm{w}}^\downarrow$.
	Note that all components of $\W{\sigma}$ are positive, so $(\tilde{\bm{w}})_i \geq 0$ if and only if $(\W{\rho})_i \geq 0$ for any $i=1,\dots,d^2$.
	
	Let $k_\star$ be the index of the smallest non-negative component of $\tilde{\bm{w}}^\downarrow$.
	Then, $(\W{\rho})_i < 0$ if and only if $i > k_\star$, so the maximum of Lorenz curve $\lc{\rho}{\sigma}(x)$ takes the value 
	\begin{equation}
		\lc{\rho}{\sigma}(x_{k_\star}) = \sum_{i=1}^{k_\star} (\W{\rho})_i,
	\end{equation}
	and is achieved at
	\begin{equation}\label{eq:maxloc}
		x_{k_\star} \coloneqq \sum_{i=1}^{k_\star} (\W{\sigma})_i.
	\end{equation}

	The location of the maximum ($x=x_{k_\star}$) varies from fragment to fragment, but its value is independent of $\sigma$,
	\begin{equation}
		\lc{\rho}{\sigma}(x_{k_\star})
		= \sum\limits_{\bmx: \W[\bmx]{\rho} \geq 0} \W[\bmx]{\rho}
		= 1 + \sn{\rho}.
	\end{equation}
	
\end{proof}

We can therefore view mana as just one of the features of the Lorenz curve, namely its maximum value. This implies the following result.
\begin{theorem}\label{thm:bounds}
    Given a magic state conversion $\rho \longrightarrow \tau$, the majorization condition is stronger than the mana condition in every $\sigma$--fragment.
\end{theorem}
\begin{proof}
    The maximum of the Lorenz curve of a state $\rho$ is independent of the $\sigma$--fragment due to~\cref{lem:lcmax}, and can be expressed as an increasing function of mana,
    \begin{equation}
        \max_{x\in[0,1]}{\lc{\rho}{\sigma}(x)} = 1 + \sn{\rho} = \frac{1}{2} \left( 1 + e^\mana{\rho} \right).
    \end{equation}
    Therefore, the $\W{\sigma}$--majorization bound
    \begin{equation}
    	\lc{\rho}{\sigma}(x) \geq \lc{\rho}{\sigma}(x),\ x\in[0,1]
    \end{equation}
    implies the order $\max_{x\in[0,1]}{\lc{\rho}{\sigma}(x)} \geq \max_{x\in[0,1]}{\lc{\rho}{\sigma}(x)}$ which is equivalent to the mana bound $\mana{\rho} \geq \mana{\tau}$.
\end{proof}

Of practical importance are magic state distillation (MSD) processes of the form
\begin{equation}\label{eq:distprocess}
    \rho^{\otimes n} \xrightarrow{\E \in \O_\sigma} \tau,
\end{equation}
where $n$ copies of a noisy magic state $\rho$ are converted into a target single-copy state $\tau$. \nick{expand?}

In general, the Wigner components of a $n$-copy state $\rho^{\otimes n}$ can be calculated directly from $W_\rho$, along with their multiplicities, by expanding the terms in the multinomial expansion $\left( \sum_{\bm{z} \in \cal{P}_d} W_\rho(\bm{z}) \right)^n$. \nick{is this clear?}
This follows from the multiplicativity of the Wigner distribution.

As an example, consider the qutrit Strange state $\ketbra{\rm{S}}$ depicted in~\cref{fig:strange}. 
It is the simplest non-trivial case to analyse because its Wigner distribution consists of two distinct components.
Calculating the components of $\ket{S}\bra{S}^{\otimes n}$ allows for analytical calculation of the maximum of the $n$-copy state,
\begin{equation}\label{eq:Skmax}
    \max_x{\lc{\ketbra{S}^{\otimes n}} {\sigma}}(x) = \frac{1}{2}\left (1 + \left(\frac{5}{3}\right)^n \right).
\end{equation}
Its location $x_{k_\star}$ depends on the $\sigma$--fragment and is given by~\cref{eq:maxloc} with $k_\star = \frac{1}{2}(7^n + 9^n)$.
%1 + \left(\frac{4}{3}\right)^n \sum\limits_{j=0}^{\floor{\frac{n-1}{2}}} 4^{-(2j+1)} \binom{n}{2j+1}
%\sum_{i=j, j: odd}^n a^j \binom{n}{j} = \frac{1}{2} [ (1+a)^n - (1-a)^n ]
%$\{(-1)^j 2^{j-n} 3^{-n}\}_{0 \leq j \leq n}$ with multiplicity $8^{n-j} \binom{n}{j}$ for the $j$-th term

Consider the problem of purifying out magic from a noisy Strange state,
\begin{equation}
    \rho_{\rm{S}}(\epsilon) = (1 - \epsilon) \ket{\rm{S}}\bra{\rm{S}} + \epsilon \sigma,
\end{equation}
in $\O_\sigma$.
At noise levels $\epsilon \geq \frac{3}{4}$, the state is sufficiently noisy so as the Wigner distribution $\W{\rho_{\rm{S}}(\epsilon)}$ no longer contains negativities. 
At any $\epsilon \leq \frac{3}{4}$, we can investigate the distillation process resulting in a single-copy state with sufficiently low target $\epsilon_{\tau}$,
\begin{equation}\label{eq:sdist}
	\noisysn \xrightarrow{\E \in \O_\sigma} \rho_{\rm{S}}(\epsilon_{\tau})
\end{equation}

The more noisy the initial state is, the more copies needed to reach the target, therefore it makes sense to define a noise level threshold 
\begin{equation}\label{eq:ethresh}
	\epsilon_{\rm{th}}(n, \epsilon_\tau, \sigma) \coloneqq \sup{\{\epsilon:\ \lc{\noisysn}{\sigma} \geq \lc{\rho_{\rm{S}}(\epsilon_{\tau})}{\sigma}\}},
\end{equation}
so that the MSD process~(\ref{eq:sdist}) is impossible for all $\epsilon > \epsilon_{\rm{th}}(n, \epsilon_\tau, \sigma)$

\nick{Condition in~\cref{eq:ethresh} is informally written. Can also define 
\begin{equation}\label{eq:ethresh}
	n_{\rm{th}}(\epsilon, \epsilon_\tau, \sigma) \coloneqq \min{\{n:\ n \in \mathbb{N}, \lc{\noisysn}{\sigma} \geq \lc{\rho_{\rm{S}}(\epsilon_{\tau})}{\sigma}\}}.
\end{equation}}
We now examine the MSD process~(\ref{eq:sdist}) in specific $\sigma$--fragments.

\subsection{Magic in unital fragments}\label{sec:unital}

Magic state distillation circuits in principle consist of bulk sequences of random Clifford unitaries ($\rcu$)\nick{CITE}, depicted in~\cref{fig:zoo}.
Operations in $\rcu$ can be expressed as
\begin{equation}
    \E(\rho) = \sum_i p_i U_i \rho U_i^\dagger,\ U_i \in \cd.
\end{equation}
Depending on the symmetries of such operations, a sequence of them may belong in various $\sigma$--fragments and the majorization condition~(\ref{eq:majbound}) needs to be checked in all these $\sigma$-fragments that reflect the symmetries of the operation sequence.
However, they always belong to the \emph{unital fragment} $\O_{\frac{1}{d}\id}$.

If one incorporates noisy channels in the circuit, for example dephasing channels as in~\cref{eq:dephase} in various bases, symmetries are reduced.
Dephasing and bit-flip error channels are examples of the many error-inducing channels that respect the unital symmetry. \nick{expand}

We plot the Lorenz curves of pure and noisy Strange state $n$-copy states for $n$ up to $4$ in~\cref{fig:lcs}.
For $n=1$, the Lorenz curve is simply additive, 
\begin{equation}
\lc{(1-\epsilon)\rho + \epsilon\sigma}{\sigma} = (1-\epsilon)\lc{\rho}{\sigma} + \epsilon\lc{\sigma}{\sigma},
\end{equation}
for any $\sigma, \rho$, but for $n\geq 2$, calculations become more complicated.

\begin{figure}%
    \centering
    \subfigure[][]{%
    \label{fig:lcs_maxmix}%
    \includegraphics[height=3cm]{figs/lcs_maxmix.pdf}
    %\caption{Maximally mixed state $\frac{1}{3}\id$}%
    }\hspace{1pt}%
    \subfigure[][]{%
    \label{fig:lcs_thermal}%
    \includegraphics[height=3cm]{figs/lcs_thermal.pdf}
    %\caption{Zero state $\ketbra{0}{0}$}%
    }\\
    \subfigure[][]{%
    \label{fig:lcs_zero}%
    \includegraphics[height=3cm]{figs/lcs_zero.pdf}
    %\caption{Bound state}%
    }\hspace{1pt}%
    \subfigure[][]{%
    \label{fig:lcs_one}%
    \includegraphics[height=3cm]{figs/lcs_one.pdf}
    %\caption{Strange state $\ketbra{S}{S}$}%
    }
    \caption{\textbf{Lorenz curves of Strange state copies.} Lorenz curves of $\noisysn$ for $n=1,2,3,4$.
    Solid lines represent pure Strange states ($\epsilon = 0$); dashed lines represent noisy Strange states ($\epsilon = 0.1$).
    \subref{fig:lcs_maxmix} Unital fragment; \subref{fig:lcs_thermal} Thermal fragment with $H = (0,1,2)$ and $\beta = 0.5$; \subref{fig:lcs_zero} Fragment $\O_{\ketbra{0}{0}}$ (corresponds to red curve in~\cref{fig:stab_distill}); \subref{fig:lcs_one} Fragment $\O_{\ketbra{1}{1}}$ (corresponds to blue curve in~\cref{fig:stab_distill}). 
    }%
    \label{fig:lcs}
\end{figure}

In~\cref{fig:unital_distill}, we examine the purifying process of~\cref{eq:sdist} with $\epsilon_\tau = 0.05$ which describes all circuits that respect the unital symmetry.
Thresholds provided by Lorenz curve comparison are always much stricter than mana thresholds.
\nick{Explain asymptotic behaviour?}
\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/unital_distill.pdf}
    \caption{\textbf{Noise thresholds in unital fragment.} Mana and Lorenz curve noise thresholds for the Strange state purification process in~\cref{eq:sdist} with $\epsilon_\tau = 0.05$.
    Lorenz curve comparison consistently gives stricter bounds as proven in~\cref{thm:bounds}.
    The line $\epsilon = \frac{3}{4}$ indicates the threshold noise beyond which the Strange state no longer contains negativities.
    }
    \label{fig:unital_distill}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/unital_distill_copies.pdf}
    \caption{\textbf{Copies required for Strange state distillation.} Mana and Lorenz curve copy thresholds for the Strange state purification process in~\cref{eq:sdist} with $\epsilon_\tau = 0.05$.
    Lorenz curve comparison consistently provides higher low bounds on the number of noisy Strange state copies required.
    }
    \label{fig:unital_distill_copies}
\end{figure}

\newpage

\subsection{Strange state Lorenz curves in the unital fragment}

In this section we analytically investigate the behaviour of the Lorenz curve of an $n$-copy Strange state in the unital fragment, 
\begin{equation}\label{eq:lcsu}
	\lc{\noisysn}{\frac{1}{d}\id}(x).
\end{equation}
An analytic handle on this type of Lorenz curves, which we call ``standard'' Lorenz curves, elevates Strange states to ``standard candles'' in the context of magic state distillation \nick{expand}.
We first present some relevant theory on error bounds of general binary codes and then show how it can be used to approximate the Lorenz curves of~\cref{eq:lcsu}.

\subsubsection{Binomial distributions and error bounds}
\textbf{Notational convention:} For any non-negative reals $a,b$ with $b\geq a$, we will denote the set of integers $n$ such that $a\leq n \leq b$ as $[a,b]$.\\

Consider an experiment consisting of $n$ trials of throwing a $p$-coin, that is a coin with probability $p$ of landing on one side and $1-p$ of landing on the other.
That could be a string of $n$ bits with bit-flip error probability $p$.

The experiment is described by binomial statistics and we define the left tail of the cumulative binomial distribution,
\begin{equation}\label{eq:phil}
	\Phi_\ell(m; n, p) \coloneqq \sum\limits_{j=0}^m \binom{n}{j} p^j (1-p)^{n-j},
\end{equation}
where $m\in [0,n]$. 

The symmetry between the left tail of a $p$-coin distribution and the right tail of a $(1-p)$-coin distribution dictates that
\begin{align}\label{eq:phi_reverse}
	\Phi_\ell(m; n, p) + \Phi_\ell(n-m-1; n, 1-p) &= 1,\ m\in [0,n-1],
\end{align}

The classical entropy of a $p$-coin is
\begin{equation}\label{eq:ent}
	S(p) \coloneqq -p\log{p} -(1-p)\log{(1-p)},
\end{equation}
which is symmetric, $S(p) = S(1-p)$.
%Let $c(m; n) \coloneqq [m(1-m/n)]^{-1/2},\ m\in [1, n-1]$.
A useful result is the entropic bound on a combination~\cite{cit:ash}.
\begin{lemma}\label{lem:comb_bounds}
	For all $m\in [1,n-1]$,
	\begin{align}
		&\left[ 8m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{nS\left(\frac{m}{n}\right)} \leq \binom{n}{m} \leq \\
		&\left[ 2\pi m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{nS\left(\frac{m}{n}\right)}.
	\end{align}
\end{lemma}
\begin{proof}
	For $m = 1,2, n-1, n-2$ check by direct calculation.	
	For all other cases, use Stirling's approximation.
\end{proof}

Bounds on the tails of a cumulative binomial distribution can be expressed in terms of the classical relative entropy between a $p$-coin and a $q$-coin,
\begin{equation}\label{eq:ent_rel}
	\ent{p}{q} \coloneqq p \log{\frac{p}{q}} + (1-p) \log{\frac{1-p}{1-q}}.
\end{equation}
This entropy satisfies the identity
\begin{equation}
	\ent{p}{q} = \ent{1-p}{1-q}.
\end{equation}

We can now derive entropic bounds on binomial cumulative distributions~\cite{cit:ash}.
\begin{lemma}\label{lem:phil_bounds}
	Given fixed $n>0$ and $p$, $\Phi_\ell$ satisfies the following bounds:
	\begin{align*}
		\begin{split}
		&\text{1. } \Phi_\ell(m; n, p) \geq \left[ 8m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ents},\ m\in [1,n-1] \\
		&\text{2. } \Phi_\ell(m; n, p) \leq 2^{-n\ents},\ m\in [0,np] \\
		&\text{3. } \Phi_\ell(m; n, p) \leq 1 - \left[ 8(m+1)\left(1-\frac{m+1}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{m+1}{n}}{p}}, \\
		&\hspace{14pt} m\in [0,n-2]
		\end{split}
		\\
		&\text{4. } \Phi_\ell(m; n, p) \geq 1 - 2^{-n\ent{\frac{m+1}{n}}{p}},\ m\in [np+1,n-2]
	\end{align*}
\end{lemma}
\begin{proof}
	\nick{cite proof}
\end{proof}

We now define the partial sums
\begin{align}	
	\Phi_+(m; n, p) &\coloneqq \sum\limits_{j=0}^{m/2} \binom{n}{2j} p^{2j} (1-p)^{n-2j}, \nonumber\\ 
	&m\in[0,n]\ \text{and }m\text{ even}, \label{eq:fp} \\
	\Phi_-(m; n, p) &\coloneqq \sum\limits_{j=1}^{(m-1)/2} \binom{n}{2j+1} p^{2j+1} (1-p)^{n-(2j+1)}, \nonumber\\ 
	&m\in[0,n]\ \text{and }m\text{ odd}. \label{eq:fn2}
\end{align}
Index $m$ only takes even (odd) values when labelling $\Phi_+$ ($\Phi_-$) and therefore we can use $\Phi_{\pm}$ to compactify statements that hold for both $\Phi_+, \Phi_-$.
In particular, we derive ``loose'' and ``strict'' bounds on $\Phi_{\pm}$.
\begin{lemma}\label{lem:bounds_loose}
	Given fixed $n>0$ and $p$, $\Phi$ satisfies the following bounds:
	\begin{align*}
		\begin{split}
		&\text{1. } \Phi_{\pm}(m; n, p) \geq \left[ 8m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ents},\ m\in [1,n-1] \\
		&\text{2. } \Phi_{\pm}(m; n, p) \leq 2^{-n\ents},\ m\in [0,np] \\
		&\text{3. } \Phi_{\pm}(m; n, p) \leq 1 - \left[ 8(m+1)\left(1-\frac{m+1}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{m+1}{n}}{p}}, \\
		&\hspace{14pt} m\in [0,n-2]
		\end{split}
	\end{align*}
\end{lemma}
\begin{proof}
	\nick{paste proof}
\end{proof}
\begin{lemma}\label{lem:bounds_strict}
	Given fixed $n>0$ and $p$, $\Phi_+, \Phi_-$ satisfy the following bounds:
	\begin{align*}
		\begin{split}
		&\text{1. } \Phi_+(m; n, p) \geq \sum\limits_{j=0}^{m/2}\left[ 8(2j)\left(1-\frac{2j}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{2j}{n}}{p}}, \\
		&\hspace{14pt} \text{for all even } m\in [2,n] \\
		&\text{2. } \Phi_+(m; n, p) \leq \sum\limits_{j=0}^{m/2}\left[ 2\pi(2j)\left(1-\frac{2j}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{2j}{n}}{p}}, \\
		&\hspace{14pt} \text{for all even } m\in [2,n] \\
		&\text{3. } \Phi_-(m; n, p) \geq \sum\limits_{j=1}^{(m-1)/2}\left[ 8(2j+1)\left(1-\frac{2j+1}{n}\right) \right]^{-\frac{1}{2}} \times \\
		&\hspace{14pt} \times 2^{-n\ent{\frac{2j+1}{n}}{p}},\ \text{for all odd } m\in [1,n] \\
		&\text{4. } \Phi_-(m; n, p) \leq \sum\limits_{j=1}^{(m-1)/2}\left[ 2\pi(2j+1)\left(1-\frac{2j+1}{n}\right) \right]^{-\frac{1}{2}} \times \\
		&\hspace{14pt} \times 2^{-n\ent{\frac{2j+1}{n}}{p}},\ \text{for all odd } m\in [1,n]
		\end{split}
	\end{align*}
\end{lemma}
\begin{proof}
	\nick{paste proof}
\end{proof}

\subsubsection{Standard Lorenz curves in terms of binomial distributions}
\textbf{Note:} We assume that the number of copies $n$ is even throughout.

The Lorenz curve $\lc{\noisysn}{\frac{1}{d}\id}$ consists of $n+1$ line segments, connecting at $n$ points, called \emph{elbows}, between the endpoints $(0,0)$ and $(1,1)$, as illustrated in~\cref{fig:lcsu_elbows}. 
\begin{figure}[b]
    \centering
    \includegraphics[scale=0.5]{figs/lccalcdiagram.pdf}
    \caption{\textbf{Anatomy of Strange state Lorenz curve}
    There are $n$ ``elbows'' in this Lorenz curve of an $n$-copy Strange state.
    Labels $k, k'$ indicate two elbows for the $n=4$ case.
    Their coordinates are given in~\cref{eq:lcsu_elbows}.
    }
    \label{fig:lcsu_elbows}
\end{figure}
We denote the Lorenz curve maximum as the $k_\star$-th point.
It occurs at 
\begin{align}\label{eq:lcsu_max}
	x_{k_\star} &= \frac{1}{2}\left(1 + \left( \frac{7}{9} \right)^n \right), \\
	L_{k_\star} &\equiv \lc{\noisysn}{\frac{1}{d}\id}(x_{k_\star}) = \frac{1}{2}\left (1 + \left(\frac{15-8\epsilon}{9}\right)^n \right),
\end{align}
with $k_\star = n/2$.
The coordinates of the standard Lorenz curve for a gien number of copies $n$ and noise level $\epsilon$ can be directly expressed in terms of $\Phi_+, \Phi_-$, for all $m$, $n$ the number of copies and some fixed $p \equiv p(\epsilon)$.

The Wigner distribution of the qutrit maximally mixed state $\id/3$ is the uniform distribution $\bm{1}/9$.
The Wigner distribution of the 1-copy noisy Strange state $\rho_{\rm{S}}(\epsilon)$ in the unital fragment is a permutation of 8 positive components ($w_+$) and 1 negative ($w_-$) with
\begin{align}
	w_+ &= \frac{1}{6} - \frac{1}{18}\epsilon \\
	w_- &= -\frac{1}{3} + \frac{4}{9}\epsilon.
\end{align}
They are depicted in~\cref{fig:noisys}.
\begin{figure}[t]
    \centering
    \includegraphics[scale=0.7]{figs/noisys.pdf}
    \caption{\textbf{Wigner components of the noisy Strange state.} 
    In the interval $0 \leq \epsilon < 3/7$, the negative component is larger than the positive components.
    At $\epsilon = 3/7$ the Wigner distribution is $(-\frac{1}{7},\frac{1}{7},\dots,\frac{1}{7})$.
    In the interval $3/7 < \epsilon < 3/4$, the positive components are larger than the negative component.
    In the interval $3/4 \leq \epsilon \leq 1$, there is no negativity.
    }
    \label{fig:noisys}
\end{figure}
The $n+1$ distinct Wigner components ($w_j$) of $\noisysn$ along with their multiplicities ($c_j$) are given in~\cref{tab:lcsu_w}.
\begin{table}[t]                           
 \centering
 \begin{tabular}{c|c|c|c}
 $\epsilon$ & $j$ & $\left[0, \frac{n}{2}\right]$ & $\left[\frac{n}{2} + 1, n \right]$ \\ [0.5ex] 
 \hline
  & $w_{j}$ & $w_+^{2j}w_-^{n-2j}$ & $w_+^{n-2j}w_-^{2j}$  \\
  $0\leq \epsilon < \frac{3}{7}$ & & & \\
  & $c_{j}$ & $8^{2j}\binom{n}{2j}$ & $8^{n-2j}\binom{n}{2j}$ \\
 \hline
  & $w_{j}$ & $w_+^{n-2j}w_-^{2j}$ & $w_+^{2j}w_-^{n-2j}$  \\
  $\frac{3}{7} \leq \epsilon < \frac{3}{4} $ & & & \\
  & $c_{j}$ & $8^{n-2j}\binom{n}{2j}$ & $8^{2j}\binom{n}{2j}$
\end{tabular}
 \caption{Wigner components of $\rho_{\rm{S}}^{\otimes n}(\epsilon)$. The multiplication $2j$ is modulo $(n+1)$.}
 \label{tab:lcsu_w}
\end{table}

To get the Lorenz curve, we need to sum up the Wigner components in decreasing order and the order depends on the noise level $\epsilon$, so we define probabilities associated with the $x$-coordinate ($p_x$) and the vertical coordinate ($p_L$) of the Lorenz curve accordingly,
\begin{equation}
	(p_x, p_L) \equiv \big( p_x(\epsilon), p_L(\epsilon) \big) = 
	\begin{cases}
		\left( \frac{8}{9}, \frac{12-4\epsilon}{15-8\epsilon} \right),\ & 0\leq \epsilon < \frac{3}{7} \\
		\left( \frac{1}{9}, \frac{3-4\epsilon}{15-8\epsilon} \right),\ & \frac{3}{7}\leq \epsilon < \frac{3}{4} \\
	\end{cases}	
\end{equation}

We are now in a position to express Lorenz curve coordinates in terms of phi distributions,
\begin{equation}
	x_k(n, \epsilon) = 
	\begin{cases}
		\Phi_+(k;n,p_x),\\
		\hspace{20pt} k\in[0,n]\ \text{and }k\text{ even}, \\
		x_{k_\star} + \Phi_-(k;n,1-p_x),\\
		\hspace{20pt} k\in[0,n]\ \text{and }k\text{ odd}, \\
	\end{cases}	
\end{equation}
and
\begin{equation}
	L_k(n, \epsilon) = 
	\begin{cases}
		\left( \frac{5}{3} - \frac{8}{9}\epsilon\ \right)^n \Phi_+(k;n,p_L),\\
		\hspace{20pt} k\in[0,n]\ \text{and }k\text{ even}, \\
		L_{k_\star} + \left( \frac{5}{3} - \frac{8}{9}\epsilon\ \right)^n\Phi_-(k;n,1-p_L),\\
		\hspace{20pt} k\in[0,n]\ \text{and }k\text{ odd}. \\
	\end{cases}	
\end{equation}

Finally, the $m$-th elbow is located at
\begin{equation}\label{eq:lcsu_elbows}
	\left(x_m, \lc{\noisysn}{\frac{1}{d}\id}(x_m) \right) = \Big( x_{2m}(n, \epsilon), L_{2m}(n, \epsilon) \Big),
\end{equation}
where $2m$ is considered \hspace{-7pt}$\mod{(n+1)}$.

We can therefore use~\cref{lem:bounds_loose,lem:bounds_strict} to bound the standard Lorenz curves.
\begin{figure}[b]
    \centering
    \includegraphics[scale=0.5]{figs/lc_bounds.pdf}
    \caption{\textbf{Lorenz curves and bounding curves.} 
    The figure explores the distillation process of a 10-copy $0.25$-noisy Strange state to a 4-copy $0.05$-noisy Strange state in the unital fragment.
    Clearly, by looking at the Lorenz curves, the distillation process is possible.
    However the bounding curves, derived in~\cref{lem:bounds_strict}, intersect at the end, suggesting that the process is not necessarily possible.
    }
    \label{fig:lc_bounds}
\end{figure}


\null\newpage
\null\newpage

The experiment is described by binomial statistics and we define the left and ``right'' tails of the cumulative binomial distribution,
\begin{align}
	\Phi_\ell(m; n, p) &\coloneqq \sum\limits_{j=0}^m \binom{n}{j} p^j (1-p)^{n-j}, \label{eq:phi}\\
	\Phi_r(m; n, p) &\coloneqq \sum\limits_{j=m}^n \binom{n}{j} p^j (1-p)^{n-j}, \label{eq:phir}
\end{align}
where $m\in [0,n]$.

They are related by the symmetry between the left tail of a $p$-coin distribution and the right tail of a $(1-p)$-coin distribution,
\begin{equation}\label{eq:phil2phir}
	\Phi_\ell(m; n, p) = \Phi_r(n-m; n, 1-p),\ m\in [0,n],
\end{equation}
as well as the normalisation condition,
\begin{equation}
	\Phi_\ell(m; n, p) + \Phi_r(m+1; n, p) = 1,\ m\in [0,n-1].
\end{equation}

Equivalently, we get
\begin{align}
	\Phi_\ell(m; n, p) + \Phi_\ell(n-m-1; n, 1-p) &= 1,\ m\in [0,n-1], \label{eq:reversephi}\\
	\Phi_r(m; n, p) + \Phi_r(n-m+1; n, 1-p) &= 1,\ m\in [1,n]. \label{eq:reversephir}
\end{align}

The classical entropy of a $p$-coin is
\begin{equation}\label{eq:ent}
	S(p) \coloneqq -p\log{p} -(1-p)\log{(1-p)},
\end{equation}
which is symmetric, $S(p) = S(1-p)$.
%Let $c(m; n) \coloneqq [m(1-m/n)]^{-1/2},\ m\in [1, n-1]$.
A useful result is the entropic bound on a combination~\cite{cit:ash}.
\begin{lemma}\label{lem:comb_bounds}
	For all $m\in [1,n-1]$,
	\begin{align}
		&\left[ 8m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{nS\left(\frac{m}{n}\right)} \leq \binom{n}{m} \leq \\
		&\left[ 2\pi m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{nS\left(\frac{m}{n}\right)}.
	\end{align}
\end{lemma}
\begin{proof}
	For $m = 1,2, n-1, n-2$ check by direct calculation.	
	For all other cases, use Stirling's approximation.
\end{proof}

Bounds on the tails of a cumulative binomial distribution can be expressed in terms of the classical relative entropy between a $p$-coin and a $q$-coin,
\begin{equation}\label{eq:ent_rel}
	\ent{p}{q} \coloneqq p \log{\frac{p}{q}} + (1-p) \log{\frac{1-p}{1-q}}.
\end{equation}
This entropy satisfies the identity
\begin{equation}
	\ent{p}{q} = \ent{1-p}{1-q}.
\end{equation}
We can now derive entropic bounds on binomial cumulative distributions~\cite{cit:ash}.
\begin{lemma}\label{lem:phir_bounds}
	Given fixed $n>0$ and $p$, $\Phi_r$ satisfies the following bounds:
	\begin{align*}
		\begin{split}
		&\text{1. } \Phi_r(m; n, p) \geq \left[ 8m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ents},\ m\in [1,n-1] \\
		&\text{2. } \Phi_r(m; n, p) \leq 2^{-n\ents},\ m\in [np,n] \\
		&\text{3. } \Phi_r(m; n, p) \leq 1 - \left[ 8(m-1)\left(1-\frac{m-1}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{m-1}{n}}{p}}, \\
		&\hspace{14pt} m\in [2,n]
		\end{split}
		\\
		&\text{4. } \Phi_r(m; n, p) \geq 1 - 2^{-n\ent{\frac{m-1}{n}}{p}},\ m\in [2,np+1]
	\end{align*}
	
	The asymptotic behaviour of $\Phi_r$ is determined by the relative entropy, 
	\begin{equation}
		\lim_{n\rightarrow\infty}{-\frac{1}{n}\log{\Phi_r(m; n, p)} = \ent{\frac{m}{n}}{p}},\ m\in [np,n]
	\end{equation}
\end{lemma}
\begin{proof}
	For bound (1), note that
	\begin{align*}
		\Phi_r(m; n, p) &= \sum\limits_{j=m}^n \binom{n}{j} p^j (1-p)^{n-j} \\
						   &\geq \binom{n}{m} p^{m} (1-p)^{n-m} \\
						   &\geq \left[ 8m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{nS\left(\frac{m}{n}\right)} p^{m} (1-p)^{n-m} \\
						   &= \left[ 8m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ents}.
	\end{align*}
	The first inequality follows from the positivity of the terms in the series, the second from~\cref{lem:comb_bounds} and the equality from the entropy definitions in~\cref{eq:ent,eq:ent_rel}
	
	For bound (2), consider a binomial random variable $X = \sum_{i=1}^N$, where $X_i$ takes the values 1, 0 with probabilities $p$ and $1-p$ respectively.
	Then we have
	\begin{align*}
		\Phi_r(m; n, p) &= P(X \geq m) = P\left(2^{rX} \geq 2^{rm}\right) \\
						   &\leq 2^{-rm} E\left(2^{rX}\right) = 2^{-rm + n\log{(1-p+pe^r)}} \\
						   &\leq 2^{-n\ents}.
	\end{align*}
	The first inequality holds for any discrete random variable $X$ with $r \geq 0$, while the second inequality involves maximisation of the exponent which occurs at $e^r = \frac{m(1-p)}{(n-m)p}$ (a non-negative $r$ exists if $np \leq m$).
	
	Bound 3 follows from bound 1 and~\cref{eq:reversephir}. Bound 4 follows from bound 2 and~\cref{eq:reversephir}.
	
	The asymptotic limit is a direct consequence of the squeeze theorem.
\end{proof}

\begin{lemma}\label{lem:phil_bounds}
	Given fixed $n>0$ and $p$, $\Phi_\ell$ satisfies the following bounds:
	\begin{align*}
		\begin{split}
		&\text{1. } \Phi_\ell(m; n, p) \geq \left[ 8m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ents},\ m\in [1,n-1] \\
		&\text{2. } \Phi_\ell(m; n, p) \leq 2^{-n\ents},\ m\in [0,np] \\
		&\text{3. } \Phi_\ell(m; n, p) \leq 1 - \left[ 8(m+1)\left(1-\frac{m+1}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{m+1}{n}}{p}}, \\
		&\hspace{14pt} m\in [0,n-2]
		\end{split}
		\\
		&\text{4. } \Phi_\ell(m; n, p) \geq 1 - 2^{-n\ent{\frac{m+1}{n}}{p}},\ m\in [np+1,n-2]
	\end{align*}
	
	The asymptotic behaviour of $\Phi_\ell$ is determined by the relative entropy,
	\begin{equation}
		\lim_{n\rightarrow\infty}{-\frac{1}{n}\log{\Phi_r(m; n, p)} = \ent{\frac{m}{n}}{p}},\ m\in [0,np]
	\end{equation}
\end{lemma}
\begin{proof}
	This lemma is a direct consequence of~\cref{lem:phir_bounds} and~\cref{eq:phil2phir}.
\end{proof}

We now define the alternating counterpart of the left tail distribution,
\begin{equation}\label{eq:phialt}
	\Phi_\ell^{\rm{alt}}(m; n, p) \coloneqq \sum\limits_{j=0}^m \binom{n}{j} (-p)^j (1-p)^{n-j},
\end{equation}
where $m\in [0,n]$.
$\Phi_\ell^{\rm{alt}}$ is \emph{not} the cumulative distribution of any random variable.
It is upper bounded by $\Phi_\ell$,
\begin{equation}\label{eq:phialt_bound}
	\abs{\Phi_\ell^{\rm{alt}}(m; n, p)} \leq \Phi_\ell(m; n, p),\ m\in [0,n]
\end{equation}
with equality iff $m=0$.

We further define the two balanced combinations of $\Phi_\ell, \Phi_\ell^{\rm{alt}}$ for all $m\in [0,n]$,
\begin{align}	
	\Phi_+(m; n, p) &\coloneqq \frac{1}{2} \left( \Phi_\ell(m; n, p) + \Phi_\ell^{\rm{alt}}(m; n, p) \right), \\
	\Phi_-(m; n, p) &\coloneqq \frac{1}{2} \left( \Phi_\ell(m; n, p) - \Phi_\ell^{\rm{alt}}(m; n, p) \right), \\
	\Phi(m; n, p) &\coloneqq \label{eq:phi}
	\begin{cases}
		\Phi_+(m; n, p),\ \text{for even }m\in[0,n] \\
		\Phi_-(m; n, p),\ \text{for odd }m\in[0,n].
	\end{cases}
\end{align}
\begin{lemma}\label{lem:phi_bounds}
	Given fixed $n>0$ and $p$, $\Phi$ satisfies the following bounds:
	\begin{align*}
		\begin{split}
		&\text{1. } \Phi(m; n, p) \geq \left[ 8m\left(1-\frac{m}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ents},\ m\in [1,n-1] \\
		&\text{2. } \Phi(m; n, p) \leq 2^{-n\ents},\ m\in [0,np] \\
		&\text{3. } \Phi(m; n, p) \leq 1 - \left[ 8(m+1)\left(1-\frac{m+1}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{m+1}{n}}{p}}, \\
		&\hspace{14pt} m\in [0,n-2]
		\end{split}
	\end{align*}
\end{lemma}
\begin{proof}
	Bound 1 follows directly from~\cref{lem:comb_bounds}.
	
	Bounds 2,3 follow from bounds 2,3 in~\cref{lem:phil_bounds} combined with~\cref{eq:phi,eq:alt_bound}.
\end{proof}
\begin{lemma}\label{lem:phi_strictbounds}
	Given fixed $n>0$ and $p$, $\Phi_+, \Phi_-$ satisfy the following bounds:
	\begin{align*}
		\begin{split}
		&\text{1. } \Phi_+(2m; n, p) \geq \sum_{0\leq j \leq m}\left[ 8(2j)\left(1-\frac{2j}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{2j}{n}}{p}}, \\
		&\hspace{14pt} m\in [1,\left\lceil\frac{n}{2}\right\rceil] \\
		&\text{2. } \Phi_+(2m; n, p) \leq \sum_{0\leq j \leq m}\left[ 2\pi(2j)\left(1-\frac{2j}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{2j}{n}}{p}}, \\
		&\hspace{14pt} m\in [1,\left\lceil\frac{n}{2}\right\rceil] \\
		&\text{3. } \Phi_-(2m+1; n, p) \geq \sum_{0\leq j \leq m}\left[ 8(2j)\left(1-\frac{2j}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{2j}{n}}{p}}, \\
		&\hspace{14pt} m\in [1,\left\lceil\frac{n-1}{2}\right\rceil] \\
		&\text{4. } \Phi_-(2m+1; n, p) \leq \sum_{0\leq j \leq m}\left[ 2\pi(2j)\left(1-\frac{2j}{n}\right) \right]^{-\frac{1}{2}} 2^{-n\ent{\frac{2j}{n}}{p}}, \\
		&\hspace{14pt} m\in [1,\left\lceil\frac{n-1}{2}\right\rceil] \\
		\end{split}
	\end{align*}
\end{lemma}
\begin{proof}
	The bounds are direct consequences of~\cref{lem:comb_bounds}.
\end{proof}

\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/phi_bounds.pdf}
    \caption{\textbf{Cumulative binomial distribution bounds}
    Distributions $\Phi_\ell, \Phi_+$ are plotted for $n=100$ and $p=1/9$.
    The first three bounds are given in~\cref{lem:phil_bounds,lem:phi_bounds} and are valid for both $\Phi_\ell$ and $\Phi_+$.
    The fourth bound is given in~\cref{lem:phil_bounds} and is only valid for $\Phi_\ell$.
    The fifth and sixth bounds are quite strict and given in~\cref{lem:phi_strictbounds} for $\Phi_+$.
    }
    \label{fig:lccalc}
\end{figure}

\subsubsection{Standard Lorenz curves in terms of binomial distributions}
The coordinates of the standard Lorenz curve can be directly expressed in terms of $\Phi_+, \Phi_-$, for all $m$, some fixed $p$ and number of copies $n$.


\null\newpage
\null\newpage


\subsection{Lorenz curves calculations}

\subsubsection{Lorenz curve ordering and maximum}

Lorenz curve analysis simplifies significantly in the unital fragment \nick{or so I thought initially}, because the invariant Wigner distribution is the uniform distribution depicted in~\cref{fig:maxmix}.
Therefore, $\W[\bmu]{(\frac{1}{d}\id)^{\otimes n}} = \frac{1}{d^{2n}}$ for all $\bmu \in \pd[d^n]$ and the ordering of the points on the Lorenz curve only depends on the ordering of the Wigner components of $\rho$.
The Lorenz curve $\lc{\ketbra{\rm{S}}^{\otimes n}}{\frac{1}{d}\id}$ consists of $n+1$ line segments, with $n$ endpoints, or ``elbows'', between $(0,0)$ and $(1,1)$. 
The $k_\star$-th endpoint is the maximum in~\cref{eq:Skmax} occuring at 
\begin{equation}
	x_{k_\star} = \frac{1}{2}\left(1 + \left( \frac{7}{9} \right)^n \right).
\end{equation}

We now investigate the location of all $n$ elbows, depicted in the diagram of~\cref{fig:lccalc}.

\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/lccalcdiagram.pdf}
    \caption{\textbf{Anatomy of Strange state Lorenz curve}
    There are $n$ ``elbows'' in this Lorenz curve of an $n$-copy Strange state.
    Labels $k, k'$ indicate elbows left and right of the maximum respectively.
    Their coordinates are given in~\cref{eq:leftelb,eq:rightelb}.
    }
    \label{fig:lccalc}
\end{figure}

Let $\overline{n} = 2\floor{\frac{n}{2}}$ be equal to $n$ if $n$ is even and $n-1$ if $n$ is odd.
Then, the positive components of the $n$-copy Strange state Wigner distribution $\W{\ketbra{\rm{S}}}$ are, in decreasing order, $6^{-n} 2^{\bar n} 2^{-j},\ j=0, 2, \dots, \bar n$ with respective multiplicites $8^{n-\bar n} 8^j \binom{n}{\bar n - j}$.
The negative components are, in decreasing order $-6^{-n} 2^j,\ j=1,3, \dots, n$ with respective multiplicities $8^n 8^{-j} \binom{n}{j}$.

\subsubsection{Lorenz curve in terms of a binomial cumulative distribution}

Denote by $\Phi(m; n, p)$ the cumulative binomial distribution,
\begin{align}
	\Phi(m; n, p) &\coloneqq \sum\limits_{j=0}^m \binom{n}{j} p^j (1-p)^{n-j}, \label{eq:phi}\\
	\Phi^c(m; n, p) &\coloneqq \sum\limits_{j=0}^m \binom{n}{j} (-p)^j (1-p)^{n-j}. \label{eq:phic}
\end{align}
Note that $\Phi(m; n, p)^c$ differs only by a factor of $(-1)^j$.
It is clear that for any $n,p$ and $m \leq n$
\begin{align}
	&\Phi(m; n, p) + \Phi(n-m; n, 1-p) = 1, \label{eq:reversef}\\
	&\Phi^c(m; n, p) \leq \Phi(m; n, p),
\end{align}
where equality in the second line holds iff $m=0$.

Let $\Phi_+(m; n, p)$ and $\Phi_-(m; n, p)$ denote the partial sums of even and odd indices respectively,
\begin{align}	
	\Phi_+(m; n, p) &= \frac{1}{2} \left( \Phi(m; n, p) + \Phi^c(m; n, p) \right), \\
	\Phi_-(m; n, p) &= \frac{1}{2} \left( \Phi(m; n, p) - \Phi^c(m; n, p) \right).
\end{align}

Assume $n$ is even, so that $\bar n = n$.
Then we can express any elbow on the $n$-copy Strange state Lorenz curve as
\begin{align}
	L_+(m; n) &= \left(\frac{5}{3}\right)^n \Phi_+\left(m;n,\frac{4}{5}\right), \label{eq:leftelb}\\
	L_-(m; n) &= L_\star - \left(\frac{5}{3}\right)^n \Phi_-\left(m;n,\frac{1}{5}\right), \label{eq:rightelb}
\end{align}
where $L_\star = L_+(n; n)$ is the maximum of the curve and $L_+, L_-$ respectively indicate the elbows on the left, right of the maximum for some index $m$.

The locations of the elbows are at
\begin{align}
	x_+(m; n) &= \Phi_+\left(m;n,\frac{8}{9}\right), \\
	x_-(m; n) &= x_\star + \Phi_-\left(m;n,\frac{1}{9}\right),
\end{align}
where $x_\star = x_+(n; n)$ is the location of the maximum.

Clearly by definition, 
\begin{align}
	\Phi_+(2m+1;n,p) &= \Phi_+(2m;n,p), \\
	\Phi_-(2m;n,p) &= \Phi_-(2m-1;n,p),
\end{align}
so we define the piece-wise functions
\begin{equation}
	L(m;n) =
	\begin{cases}
	L_+(m; n),&\ m\text{: even}, \\
	L_-(m; n),&\ m\text{: odd}
	\end{cases}
\end{equation}
and
\begin{equation}
	x(m;n) =
	\begin{cases}
	x_+(m; n),&\ m\text{: even}, \\
	x_-(m; n),&\ m\text{: odd}
	\end{cases}
\end{equation}
Finally, the $m$-th elbow is located at
\begin{equation}\label{eq:slc}
	\left(x_m, \lc{\ketbra{\rm{S}}^{\otimes n}}{\frac{1}{d}\id}(m) \right) = \left( x(2m;n), L(2m;n) \right),
\end{equation}
where $2m$ is considered \hspace{-7pt}$\mod{(n+1)}$.

\subsubsection{Bounds on cumulative distribution}

We now want to bound these points for any index $m$, so as to investigate the asymptotic behaviour of the Lorenz curves.
We first define a useful function
\begin{equation}
	c(m;n) = 
	\begin{cases}
		0,&\ m=0, \\
		\left[8m\left(1-\frac{m}{n}\right)\right]^{-1/2},&\ 0<m<n, \\
		1,&\ m=n,
	\end{cases}
\end{equation}
as well as the classical relative entropy,
\begin{equation}
	S(\alpha||\beta) \coloneqq \alpha \log{\frac{\alpha}{\beta}} + (1-\alpha) \log{\frac{1-\alpha}{1-\beta}}.
\end{equation}

We now define two functions that we use to bound $\Phi(m;n,p)$,
\begin{align}
	U(m;n,p) &\coloneqq	e^{-nS\left(\frac{m}{n}||p \right)} \label{eq:ubd}, \\
	L(m;n,p) &\coloneqq c(m;n)e^{-nS\left(\frac{m}{n}||p \right)} \label{eq:lbd}.
\end{align}

\begin{lemma}\label{lem:ulbd}
	The cumulative distribution $\Phi(m;n,p)$ defined in~\cref{eq:phic} is exponentially bounded for all $m: 0\leq m \leq n$,
	\begin{equation}
		B_L(m;n,p) \leq \Phi(m;n,p) \leq B_U(m;n,p),\ m\leq np
	\end{equation}
	where
	\begin{equation}
		B_L(m;n,p) = \\
		\begin{cases}
			L(m;n,p),&\ m \leq np, \\
			1 - U(n-m;n,1-p),&\ m > np,
		\end{cases}
	\end{equation}
	and
	\begin{equation}
		B_U(m;n,p) =
		\begin{cases}
			U(m;n,p),&\ m \leq np, \\
			1 - L(n-m;n,1-p),&\ m > np.
		\end{cases}
	\end{equation}
\end{lemma}

The bounds are demonstrated in~\cref{fig:phi} for the interesting cases of $\Phi\left(m;n,\frac{1}{5}\right),\Phi\left(m;n,\frac{4}{5}\right)$.

\begin{figure}%
    \centering
    \subfigure[][]{%
    \label{fig:phi1}%
    \includegraphics[height=5cm]{figs/Phi.pdf}
    %\caption{Maximally mixed state $\frac{1}{3}\id$}%
    }\\%
    \subfigure[][]{%
    \label{fig:phi4}%
    \includegraphics[height=5cm]{figs/Phi2.pdf}
    %\caption{Zero state $\ketbra{0}{0}$}%
    }
    \caption{Distributions $\Phi(m;n,p)$ (black) and $\Phi^c(m;n,p)$ (red) for $n=30$ and probability: 
    \subref{fig:phi1} $p=\frac{4}{5}$; \subref{fig:phi4} $p=\frac{1}{5}$.
    The upper and lower bounds on $\Phi(m;n,p)$ as stated in~\cref{lem:ulbd} are also presented. 
    }%
    \label{fig:phi}
\end{figure}

We see in~\cref{fig:phicmax} that distribution $\Phi^c(m;n,p)$ is also bounded by a constant number $\epsilon$, $0<\epsilon<1$ for all $m$.
The bound $\epsilon$ tends to decrease as $n$ increases, so that $\abs{\Phi^c(m;n,p)} \leq \frac{1}{10}$ for $n\geq 30$.

\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/Phic_max.pdf}
    \caption{Maximum of the absolute value of $\Phi^c(m;n,p)$ over all $m$ for given $n$.
    Here, we plot for all even $n$, $2\leq n\leq 30$.
    The maximum is decreasing in $n$ and falls below $\frac{1}{10}$ for $n=30$.
    \nick{we want to extract exponential bound from this graph instead of constant bound}.
    }
    \label{fig:phicmax}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/Phi_ratio.pdf}
    \caption{Distributions $\Phi_+(m;n,p)$ (blue) and $\Phi_-(m;n,p)$ (orange) for $n=20$ and $p=\frac{4}{5}$.
    The green curve is the ratio of the two
    }
    \label{fig:Phi_ratio}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/Phi_nexp.pdf}
    \caption{Distributions $\Phi_+(m;n,p)/U(m;n,p)$ (blue) and $\Phi_-(m;n,p)/U(m;n,p)$ (orange) for $n=30$ and $p=\frac{4}{5}$.
    We divide by the bound in~\cref{eq:ubd} to extract the exponential behaviour of the two distributions.
    Here, $np = 24$, so for $m\geq 24$, $U(m;n,p) = 1$.
    }
    \label{fig:phinexp}
\end{figure}

\subsubsection{Noisy Strange states}

Strange states of the form 
\begin{equation}
    \rho_{\rm{S}}(\epsilon) = (1 - \epsilon) \ket{\rm{S}}\bra{\rm{S}} + \epsilon \frac{1}{d}\id,
\end{equation}
contain two discrete Wigner components, so $n$-copy states $\rho_{\rm{S}}^{\otimes n}(\epsilon)$ contain $n+1$ discrete components~\cref{tab:swc} as in the noiseless case.
\begin{table}[h]                           
 \centering
 \begin{tabular}{|c|c|}
 \hline
 $m_j$ & $8^{n-j}\binom{n}{j}$ \\ [0.5ex] 
 \hline\hline
 $w_j$ & $\left(\frac{1}{6} - \frac{1}{18}\epsilon \right)^{n-j}\left(-\frac{1}{3} + \frac{4}{9}\epsilon \right)^{j}$ \\
 \hline
\end{tabular}
 \caption{Wigner components of $\rho_{\rm{S}}^{\otimes n}(\epsilon)$}
 \label{tab:swc}
\end{table}

Clearly, there are negative Wigner components iff $0\leq \epsilon < \frac{3}{4}$.
At the limiting case of non-negative Wigner components $\epsilon = \frac{3}{4}$, the Lorenz curve is simply given by three points,
\begin{equation}
\left\{(0,0), \left(\left(\frac{8}{9}\right)^n, 1\right), (1,1) \right\}
\end{equation}
and exponentially tends to a step-function.
The case of $\epsilon = 0$ is given at~\cref{eq:slc} and the noisy cases with $0 < \epsilon < \frac{3}{4}$ follow a similar analysis.

\newpage

\subsection{Magic in thermal fragments}\label{sec:thermal}

Consider a system driven by Hamiltonian $H$ and a circuit consisting of thermal operations.
The computational basis now coincides with the Hamiltonian eigenbasis.
We denote the thermal state at temperature $\beta^{-1}$ by $\gamma_\beta = \frac{e^{-\beta H}}{\Z_\beta}$, where $\Z_\beta = \tr[e^{-\beta H}]$.\nick{expand}

Thermal operations coincide with fragment $\O_{\gamma_\beta}$ \nick{expand}.
The Wigner distribution of any thermal state $\gamma_\beta$ always consists of strictly positive components,
\begin{equation}
	\W[\bmx]{\gamma_\beta} = \frac{e^{-\beta \epsilon_{x_0}}}{d\Z_\beta}\ \text{for all}\ \bmx \in \pd,
\end{equation}
so pre-order $\prec_{\gamma_\beta}$ is well defined.

We generalise the analysis of unital fragments into any circuit with thermalisation noise parametrised by the temperature $\beta^{-1}$.
In~\cref{fig:thermal_distill}, we examine the majorization bound for the same purification process of~\cref{eq:sdist} with $\epsilon_\tau = 0.05$.
The curves plotted suggest that there exists a fragment $\O_{\gamma_{\beta_{\rm{max}}}}$ which allows for a highest noise threshold at any given number of copies of the initial state.
Adding more copies results in a lower optimal temperature $\beta^{-1}$.

\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/thermal_distill.pdf}
    \caption{\textbf{Threshold dependence on temperature in thermal fragments.} Lorenz curve ratios for the Strange state purifying process in~\cref{eq:sdist} with $\epsilon_\tau = 0.05$.
    The peaks of each curve indicate the optimal temperature $\beta_{\rm{max}}$ that allows for the highest noise threshold at every given number of initial state copies $k$.
    The line $\epsilon = \frac{3}{4}$ indicates the threshold noise beyond which the Strange state no longer contains negativities.
    }
    \label{fig:thermal_distill}
\end{figure}

\newpage

\subsection{Magic in pure stabilizer fragments}\label{sec:magstab}

There exist $d(d+1)$ pure stabilizer states for a $d$-dimensional system, all of which correspond to a uniform distribion over an affine line in the phase space \nick{CITE}.
As an example, the distribution of the qutrit zero state $\ketbra{0}$ is illustrated in~\cref{fig:zero}.
Any pure stabilizer state $\sigma$ is a rank--$1$ state and contains $d^2 - d$ zeros in its Wigner distribution, so we approximate it by the full--rank state $\sigma' = (1-\epsilon)\sigma + \epsilon \frac{1}{d}\id$ for some infinitesimal $\epsilon > 0$.

We explore the distillation process of~\cref{eq:sdist} in these modified fragments $\O_\sigma'$ in~\cref{fig:stab_distill}.
We repeat the plot for distillation of Norrell states in~\cref{fig:stab_distill_norrell}.


\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/stab_distill.pdf}
    \caption{\textbf{Strange state distillation thresholds in stabilizer fragments.} Lorenz curve thresholds for the Strange state purifying process in~\cref{eq:sdist} with $\epsilon_\tau = 0.05$.
    All $12$ stabilizer fragments produce two distinct trends: ($k=0$ - red curve) the stabilizer states that have non-zero value at the origin of the phase space lie low and ($k=1,2$ - blue curve) the stabilizer states that have a zero value at the origin of the phase space lie high.
    This is specific to the Strange state.
    For high enough copies, these Lorenz curves surpass the unital noise threshold $\epsilon_{\rm{th}} = \frac{3}{4}$.
    }
    \label{fig:stab_distill}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[scale=0.5]{figs/stab_distill_norrell.pdf}
    \caption{\textbf{Norrell state distillation thresholds in stabilizer fragments.} Lorenz curve thresholds for the Strange state purifying process in~\cref{eq:sdist} with $\epsilon_\tau = 0.05$.
    For high enough copies, certain Lorenz curves surpass the unital noise threshold $\epsilon_{\rm{th}} = \frac{3}{4}$.
    }
    \label{fig:stab_distill_norrell}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Lower bounds in $\sigma$-fragments}
\ddd{[Am throwing down some rough material, to be polished later.]}

In order to obtain lower bounds one must now make precise what the free operations actually are in the  theory, beyond the condition of preserving Wigner-positivity.

We first consider the unital fragment, and consider the transformations possible using Clifford unitaries, and convex mixtures of Clifford unitaries. We denote the Clifford group as $\C$, and given some quantum state $\rho$ the accessible states in the unital fragment are given by $\E(\rho) = \sum_{g \in \C} p(g) U(g) \rho U(g)^\dagger$.

\subsection{Symplectic majorization of magic state Wigner distributions.}
We now exploit the the group structure, which leads to a more general notation majorization that has been extensively studied in the classical context, but to our knowledge has not yet been used in quantum information theory.

\begin{definition} Given a group $G$ that acts on a vector space $V$, we say that $\bmx$ \emph{$G$-majorises} $\bmy$ precisely when $\y \in H(\x)$, where $H(\x)$ is the convex hull of $\{g \x : g \in G\}$. We denote this as $\y \prec_G \x$.
\end{definition}

Now any quantum state $\rho$ has a Wigner distribution $W_\rho(\x)$. Given a Clifford unitary $\U \in \C$ we have that its representation in the Heisenberg-Weyl frame is given by
\begin{equation}
W_{\U(\rho)} (\x) = [\mbox{\ddd{fill in}}].
\end{equation}

This group action corresponds to the action of the affine symplectic group on the discrete phase space $\P_d$. To proceed we can study the discrete translational action, and the symplectic action separately.

\subsection{Cyclic majorization conditions.}
We can consider for $G$, the cyclic group of order $N$, which is described by $G= \< g | g^N = e\>$. in Terms of the Wigner distributions, this arises for the discrete lattice translations arising from displacement operators.

A set of necessary and sufficient conditions for cyclic majorization has been obtained and is given as follows. Suppose $\x, \y$ are two real vectors in $\mathbb{R}^n$. Let $\Delta$ be the elementary shift operator, defined by
\begin{equation}
\Delta \x = \Delta (x_1, x_2, \dots, x_n) := (x_n, x_1, x_2, \dots, x_{n-1}),
\end{equation}
and from this it is clear that $\Delta$ generates a representation of the abelian group $(\mathbb{Z}_n,+)$.
We now say that $\x$ \emph{cyclically majorizes} $\y$, written $\x \succ_C \y$, if and only if 
\begin{equation}
\y = \sum_{k=0}^{n-1} p_k \Delta^k \x,
\end{equation}
for some probability distribution $p=(p_k)$. This means that $\y$ lies in the convex hull of the orbit of $\x$ under cyclic shifts. Thus, we may write this condition as $\y = L(\p) \x$, where
\begin{equation}
L(\p) :=  \sum_{k=0}^{n-1} p_k \Delta^k,
\end{equation}
is a linear operator, as a function of an unknown distribution $\p$. We now have the following key identity for linear operators of this form:
\begin{equation}
L(\p)\x = QL(\x) \p,
\end{equation}
where $Q$ is a permutation matrix sending $e_0:=(1,0,0,\dots ,0)$ to itself, and otherwise sending $e_k$ to $e_{n-1-k}$, where $e_k=  (0,0,\dots, 0,1,0,\dots, 0)$ is the $k$'th basis vector. We thus have
\begin{align}
\x \succ_C \y &\Leftrightarrow \y = L(\p) \x \mbox{ for some dist. } \p. \nonumber \\
&\Leftrightarrow \y = QL(\x) \p \mbox{ for some dist. } \p. \nonumber \\
&\Leftrightarrow [QL(\x)]^{-1}\y = \p \mbox{ for some dist. } \p. \nonumber \\
&\Leftrightarrow [QL(\x)]^{-1}\y = \p  \ge \mathbf{0} \mbox{ and normalized}.
\end{align}
This implies that to check whether $\x \succ_C \y$ it suffices to compute the components of the left-hand side and ensure non-negativity (I suspect it is normalised if $\x$ and $\y$ are normalised).

Note though that by using Fourier analysis we can simplify this in terms of computational demands to checking if the vector
\begin{equation}
\p = C(\x') Q\y,
\end{equation}
has non-negative components, where
\begin{equation}
\x' := n\F_n [\F_n\x]^{-1},
\end{equation}
with $\F_n$ being the discrete Fourier transform, and the bracket term $[\F_n \x]^{-1}$ denotes the vector obtained by inverting the components of $\F \x$ individually. So the recipe for cyclic majorization is:
\begin{enumerate}
\item Given inputs $\x$ and $\y$.
\item Compute the vector $\x'$ via two Fourier transforms and $n$ inversions.
\item Compute the circulant matrix $C(\x')$.
\item Compute $\C(\x')Q \y$ and check if all components are non-negative.
\end{enumerate}•


\subsection{Symplectic majorization for qutrit magic}
The qutrit system provides a good illustration of the techniques. In this case the symplectic group $SL(2,\mathbb{Z}_3)$ is isomorphic (up to $\pm \I$) the symmetry group of the tetrahedron, which in turn is isomorphic to $S_4$, the permutation group on 4 symbols. Therefore we expect in this case that symplectic majorization on $\P_3$ corresponds to a restricted form of majorization.


\subsection{Fundamental Regions of a group $G$}
\ddd{[This is theory for the appendices, and also to help flesh out the theory of $G$ majorization. It looks a bit technical, but the core idea is simple enough once you get it.]}
Given a group $G$ that acts on a vector space $V$, we now have the following concept.
\begin{definition} A \emph{fundamental region} $F$ of $G$ in $V$ is any open set $F$ such that $F \cap gF = \varnothing$ for $g \ne e$ and moreover 
\begin{equation}
V = \bigcup_{g} \overline{g F}.
\end{equation}
\end{definition}
Here, the overline denotes the closure of a set. Loosely speaking, we can view $F$ as obtained by quotienting the vector space $V$ via the group action. We then have the following key theorem, which is proved in [CITE].
\begin{theorem} If $G$ has a fundamental region $F$ that is unique, modulo actions of the group $F\rightarrow gF$, then $\bar{F}$ is a closed, convex cone and for any $\x, \y \in \bar{F}$ we have
\begin{equation}
\y \prec_G \x \Leftrightarrow \mathbf{a}\cdot \y \le \mathbf{a} \cdot \x, \mbox{ for all } \mathbf{a} \in \bar{F}.
\end{equation}
\end{theorem}
If the cone $\bar{F}$ is finitely generated, namely 
\begin{equation}
\bar{F} = \mbox{cone}( \mathbf{c}_1, \dots, \mathbf{c}_N),
\end{equation}
for some finite set of vectors, then the majorization condition reduces to checking a \emph{finite} set of inequalities, namely checking $\mathbf{c}_k \cdot \y \le \mathbf{c}_k \cdot \x$ for $k=1, \dots , N$.

Note now that any group action $G$ on a vector space $V$ always has a fundamental region. Consider any $\x \in V$ such that $g \x \ne \x$ unless $g =e$. For this we define
\begin{equation}
K = \{ \mathbf{a} \in V : \sup_g \left [ (g\mathbf{a})\cdot \x \right ] = \mathbf{a} \cdot \x \},
\end{equation}
then $F = K_{\mbox{\tiny int}}$ is a fundamental region of $G$ in $V$, where $ K_{\mbox{\tiny int}}$ is the interior of the set $K$. In simple terms, this fundamental region corresponds to the set of vectors that are `close' to $\x$, in the sense that any non-trivial group action $\mathbf{a} \rightarrow g \mathbf{a}$ on them moves them away from $\x$ with respect the inner product. See [CITE] for a proof of this statement.

\subsection{Computing the fundamental region $F$ for the qutrit}
Firstly, note that we actually have that $SL(2, \mathbb{Z}_3)$ is represented by $U(g)$ on $\P_3$, and so we should use that notation for precision.

Since the symplectic group for $d=3$ is a reflection group, it turns out that this guarantees that an essentially unique fundamental region exists, and so we can reduce to a \emph{finite} set of majorization conditions (I think 5 in this case). Note that the $K$ defined above is always a closed, convex cone. This means it should be `easy' to determine the fundamental region. Reflection groups are Coexter groups, and I believe this set $K$ is essentially a Weyl chamber in that language. Anyhow, let's not get distracted by abstraction.


The concrete recipe going forward:
\begin{enumerate}
\item Pick your favorite $\x \in P_3$ that is \emph{not} stabilized by $g\ne e$. I.e. a vector that moves under all non-trivial group actions.
\item For each $g_k$ look for the extremal cases of $\y$ such that have constant inner product with $\x$. This corresponds to 
\begin{equation}
\left [ (U(g_k) -\I) \y \right ] \cdot \x = 0 \mbox{ for }k=1, \dots ,24.
\end{equation}
Or equivalently,
\begin{equation}
\y \cdot A^T\x = 0,
\end{equation}
where $A := U(g_k) -\I$.
\item Write down the matrix equation for each $g_k$.
\item Each of these conditions defines a hyperplane $H_k$ in $\P_3$ corresponding to the boundary of $K$.
\item We possibly don't need to range over all 24 group elements....but am not sure on this.
\item From this, we should be able to extract a generating set of vectors.
\end{enumerate}

\subsection{Toy example to see how the algorithm works}
Okay, let's see how it works in a simple case. Let's consider the case of $V= \mathbb{R}^2$ and $G=S_2=\<g|g^2=e\>$ with the group action $g.(x,y) = (y,x)$ that swaps the components of the vector. We should get standard majorization out of this $G$--majorization.

First we find an $\x$ that transforms non-trivially under non-trivial group actions. The vector $\x=(1,0)$ does this. To construct a fundamental region we now look at the equation 
\begin{equation}
[g.(x,y) - (x,y)] \cdot (1,0) = 0
\end{equation}
and solve for $x,y$. This becomes,
\begin{equation}
(y-x, x-y)\cdot(1,0)=0,
\end{equation}
which implies the hyperplane (line!) $y=x$ is the \emph{boundary} of the fundamental region. Since we decided to start with $(1,0)$ we can take the region to the right of this line, and so:
\begin{equation}
F = \{(x,y) : x>y \}
\end{equation}
where we note that we use the strict inequality to get the interior. The region $\bar{F}$ is a half-space, but this is actually a cone, and can be written as
\begin{equation}
F= \mbox{cone}( (1,1),(-1,-1), (5,0)).
\end{equation}
The first two vectors give the boundary, and we just need one other vector inside $F$ to generate it fully, chosen arbitrarily to be $(5,0)$. This last one is needed since $(1,1)$ and $(-1,-1)$ are linearly dependent! Therefore
\begin{align}
\mathbf{c}_1 &= (1,1) \nonumber \\
\mathbf{c}_2 &= (-1,-1) \nonumber \\
\mathbf{c}_3 &= (5,0).
\end{align}
The $S_2$--majorization ordering is then given by
\begin{equation}
\y \prec \x \Leftrightarrow \mathbf{c}_k \cdot \y \le  \mathbf{c}_k \cdot \x,
\end{equation}
for $k=1,2,3$ whenever $\x,\y \in F$. Note that is gives the ordering for all vectors in the space, since any general vector can be transformed into $F$ via a group action, since $F$ is a fundamental region. Indeed mapping an $\x$ into $F$ is simply $\x \rightarrow \x^\downarrow$, the sorting maneuver!
The generating vectors $(1,1)$ and $(-1,-1)$ imply that both 
\begin{equation}
y_1 + y_2 \le x_1 +x_2,
\end{equation}
and
\begin{equation}
y_1 + y_2 \ge x_1 +x_2,
\end{equation}
which becomes the majorization condition
\begin{equation}
y_1+y_2 = x_1 + x_2.
\end{equation}
Easy! The final condition from $\mathbf{c}_3=(1,0)$ is then the condition that
\begin{equation}
5y_1 \le 5x_1 \Rightarrow y_1 \le x_1,
\end{equation}
which is the final majorization condition. Thus we have shown how the familiar majorization structure corresponds to the theory of $G$--majorization, and the cone ordering structure that comes from fundamental regions.

\subsection{Another toy example -- non-standard majorization this time}
Okay, let's look at another option for $V=\mathbb{R}^2$. Now consider the group $G=\mathbb{Z}_2 \times \mathbb{Z}_2$ that can be represented as $G=\<g_1,g_2 | g^1=e, g_2 = e, g_1g_2 = g_2g_1\>$, and acts on vectors as $g_1.(x,y) = (-x,y), g_2.(x,y)=(x,-y)$. In other words the group just flips vectors about X/Y axes.

A vector that moves under the non-trivial group actions is $(1,1)$, so we use this one and solve for $[g.(x,y) - (x,y)] \cdot (1,1) = 0$. We have for $g = g_1$ the equation
\begin{equation}
[(-x,y) - (x,y)]\cdot (1,1) = 0,
\end{equation}
which implies the line $x=0$.

For $g=g_2$ we have
\begin{equation}
[(x,-y) - (x,y)]\cdot (1,1) = 0,
\end{equation}
which implies the line $y=0$.

For $g=g_1g_2$ we have
\begin{equation}
[(-x,-y) - (x,y)]\cdot (1,1) = 0,
\end{equation}
which implies the line $x+y=0$. The open region bounded by these three conditions is the set
\begin{equation}
F := \{ (x,y) : x>0, y>0\}.
\end{equation}
So the positive quadrant of $\mathbb{R}^2$ is a fundamental region for $G$, which makes sense since via sign flips we can map this onto the whole plane, once we close the set. This is again a convex cone and $\bar{F} = \mbox{cone}((1,0), (0,1))$. Thus given any two vectors $\x,\y$ we first act with $G$ to flip their signs so that their components are all positive, $\x \rightarrow \x^\star\ge \mathbf{0}$, then $\y \prec_G \x$ if and only if $y_1 \le x_1$ and $y_2 \le x_2$. This implies that 
\begin{equation}
\y \prec_G \x \Leftrightarrow \y^\star \le \x^\star. 
\end{equation}
So the $G=\mathbb{Z}_2 \times \mathbb{Z}_2$ majorization gives the component-wise ordering on vectors once you sort them. It is clear that this extends to any $G=\mathbb{Z}_2^{\times n}$.
\subsection{A more complex example $S_3$ on $\mathbb{R}^3$.}
So the symmetric group $S_n$ always gives majorization. But the symmetric group has $|S_n| = n!$ elements to it, which is super-exponentially big in $n$. We clearly don't have to check $n!$ equations, since the majorization conditions involve just $n+1$ inequalities, and so it must be that the basic generating conditions of the group suffice to determine the fundamental region of $G$.

Let's look at $V = \mathbb{R}^3$ and $G=S_3$ acting on $\x = (x_i)$ as $g.\x = (x_{g^{-1}}(i))$. A vector that transforms non-trivially under all non-trivial actions is $(2,1,0)$. Let's look at the transpositions, and the boundary planes they give first.

For $g= (1\,\,2)$ we have the equation
\begin{equation}
[(y,x,z) - (x,y,z)] \cdot (2,1,0) = 0,
\end{equation}
which implies the plane $2(y-x)+ x-y = 0$, namely,
\begin{equation}
H_1 = \{(x,y,z) : y=x\}.
\end{equation}
The other choices of transpositions work the same and give the planes
\begin{align}
H_2 &= \{(x,y,z) : y=z\} \\
H_3 &= \{(x,y,z) : x=z\}.
\end{align}
Note that their intersection gives the line $\{(x,y,z) : x=y=z\}$, which is the line of uniform vectors at the bottom of the majorization pre-order.

What information do the $3$-cycles give? Okay, let's now look at $g=( 1 \,\, 2 \,\, 3)$. The core equation for this becomes
\begin{equation}
[(z,x,y) - (x,y,z)] \cdot (2,1,0) = 0,
\end{equation}
and so gives
\begin{align}
2(z-x) + (x-y) &= 0 \nonumber \\
\Rightarrow x+y &=2z. 
\end{align}
Namely the plane
\begin{equation}
H_4 = \{(x,y,z) :  x+y =2z\}.
\end{equation}The remaining $3$--cycle $(3\,\,2\,\,1)$ gives
\begin{align}
H_5 &= \{(x,y,z) : y+z = 2x\}.
\end{align}
Note that $|S_3| = 6$, but the identity element $g=e$ gives no constraint, and so there are exactly $5$ bounding planes. Note also that the line $\{ (t,t,t)\} $ is again the intersection of all the planes.

These 5 planes bound a cone containing $(2,1,0)$, namely the fundamental region $F$. What's a good algorithm to obtain a generating set of vectors for this cone?

Firstly, since the line $\{(t,t,t)\}$ being the intersection of all the planes, is definitely on the boundary of $F$, this means we must have $\mathbf{c}_1 = (1,1,1)$ and $\mathbf{c}_2 = (-1,-1,-1)$ in our generating set. Perhaps a good algorithm is to compute intersections, obtain generating vectors for these intersections of the hyperplanes, $H_{ij}$ and then let $K_i$ and $K_j$ be the half-spaces in which $(2,1,0)$ resides. Now the intersection of two cones, is itself a cone so we can just keep intersecting the half-space/cones. Thus, we compute
\begin{align}
H_{12} &:= H_1 \cap H_2 \\
&=\{ (t,t,t) : t\in \mathbb{R}\}=:L.
\end{align}
Similarly, $H_{13} = H_{23}= L$. What about the other intersections? Well $H_{14} = H_{15}=L$. In fact all intersections are the same! 
\begin{equation}
H_{ij} = H_i \cap H_j = L \mbox{ for all } i,j.
\end{equation}
The fundamental region is given by the intersection of $K_1$ and $K_2$, or any other two half-spaces. This is generated by $\mathbf{c}_1$ and $\mathbf{c}_2$ above, and any two independent vectors in the intersection of these half-spaces. We can choose 
\begin{align}
\mathbf{c}_3 &= (1,1,0) \\
\mathbf{c}_4 &= (1,0,0),
\end{align}
note that $\mathbf{c}_3 \in H_1$ and $\mathbf{c}_4 \in H_2$, while $\mathbf{c}_3 \in K_2$ and $\mathbf{c}_4 \in K_1$ and so this works correctly. We thus have
\begin{equation}
\bar{F} = \mbox{cone}(\mathbf{c}_1 ,\mathbf{c}_2 ,\mathbf{c}_3 ,\mathbf{c}_4 ).
\end{equation}
The first two inequalities give the condition that
\begin{equation}
x_1+x_2+x_3 = y_1+y_2+y_3,
\end{equation}
while the remaining two conditions give the inequalities
\begin{align}
y_1 &\le x_1 \\
y_1+y_2 &\le x_1 +x_2.
\end{align}
This is the standard majorization relation. Geometrically, the cone $\bar{F}$ is actually a funny one to visualise: it consists of a half-line radiating out from $(0,0,0)$ to $(-1, -1, -1)$, together with the triangular ``infinite pyramid'' generated by positive combinations of $(1,1,1), (1,1,0), (1,0,0)$. But we can also take positive linear combinations of $(-1,-1,-1)$ and e.g. $(1,1,0)$ and so it is still a bit tricky to visualise.
\subsection{Symplectic majorization for $d =5$ and beyond.}
For the case $d=5$ we also have a particularly simple group structure, where now the symplectic group $SL(2, \mathbb{Z}_5)$ is isomorphic to the symmetry group of the icosahedron. This is another reflection group and therefore we can again obtain the finite set of majorization conditions to describe it. Here the order of the group is $60$ and so we probably shouldn't make Nick compute this by hand.
\newpage
\section{Extension to general quantum resource theories}
\label{sec:frag}

In the previous section we introduced the notion of $\sigma$--fragments for any resource theory of magic. In this section we pause to generalise this concept to an arbitrary resource theory and explain precisely how it connects with resource monotones. The busy reader more focussed on magic may skip this section.

State convertibility within a given resource theory is often a hard question to address due to the intricate structure of the theory.
In general, the structure of a theory $\R$ is described by a pre-order $\prec_\R$ and usually resource monotones are employed to reduce this structure into a simple real number ordering\nick{CITE}.
The subdivisions of magic theories into $\sigma$--fragments suggests a new approach towards investigating state convertibility which retains more structure of the origin theory than a measure can.

\subsection{Monotones}\label{sec:mono}

We highlight the defining property of a monotone for the discussion that follows.
\begin{definition}[\textbf{Resource monotone}]\label{def:mono}
    Let $\R = (\F, \O)$ be a resource theory.
    A resource monotone $\M$ is a projection from the set of quantum states of the theory onto the real line, so that $\M$ is monotonically decreasing under free operations,
    \begin{equation}
        \M(\rho_1) \leq \M(\rho_2)\ \text{whenever}\ \rho_1 \prec_{\R} \rho_2.
    \end{equation}
\end{definition}
The monotonicity condition reflects the no resource generating property of free operations, so that monotones respect the pre-order $\prec_\R$ of the theory.
Furthermore, a monotone may also satisfy the additivity condition,
\begin{equation}
    \M(\rho_1 \otimes \rho_2) = \M(\rho_1) + \M(\rho_2).
\end{equation}
This optional condition is of practical importance for resource distillation, which we discuss in~\cref{sec:distill} within the context of magic.

The most fundamental and commonly used magic monotone is the \emph{mana} of a state \nick{CITE}, defined as
\begin{equation}
    \mana{\rho} \coloneqq \log{\left(\sum\limits_{\bmz \in \pd} \abs{\W[\bmz]{\rho}}\right)}.
\end{equation}
It is a monotone function of the $\ell_1$-norm of the Wigner distribution that satisfies the additivity condition.
In particular, mana can be re-expressed as $\mana{\rho} = \log{(2\sn{\rho}+1)}$, where the sum-negativity ($\rm{sn}$) \nick{CITE} is the sum of the negative components in $\W{\rho}$,
\begin{equation}
	\sn{\rho} = \sum\limits_{\bmx: \W[\bmx]{\rho} < 0} \abs{\W[\bmx]{\rho}}.
\end{equation}

\subsection{Fragments}

Monotones reduce the structure of the resource theory $\R$ to a \emph{total} order on the real numbers.
Therefore, two states, even if incomparable in $\R$, are always mapped onto ordered real numbers.
We now generalise this idea of a theory projection that preserves comparability between states. 
\begin{definition}[\textbf{Covariant projection}]\label{def:covproj}
Let $\R = (\F, \O)$ be a resource theory with pre-order $\prec_\R$. 
Then a \emph{covariant resource projection} of $\R$ to a resource theory $\R'$ with pre-order $\prec_{\R'}$, is a pair of mappings $(\Pi_s, \Pi_o)$, where $\Pi_s$ maps quantum states in $\R$ to quantum states in $\R'$, and $\Pi_o$ maps free operations in $\R$ to free operations in $\R'$. 
Moreover, these obey
	\begin{enumerate}
        \item $\Pis(\rho_1) \prec_{\R'} \Pis(\rho_2)$ whenever $\rho_1 \prec_\R \rho_2$;
        \item $\Pio(\E) = \Pio(\E_1) \circ \Pio(\E_2)$ whenever $\E = \E_1 \circ \E_2$.
    \end{enumerate}
We call $\R'$ a \emph{covariant fragment} of $\R$.
\end{definition}

Resource monotones can now be clearly seen as a special case of covariant resource projections.
\begin{proposition}[\textbf{Totally ordered covariant theories}]\label{thm:monoproj}
	Any resource monotone $\M$ of a resource theory $\R$ is a covariant projection for which $\prec_{\R'}$ is a total order. 
	Conversely, any such covariant projection corresponds to a resource monotone $\M$. 
\end{proposition}
\begin{proof}
	Consider a monotone $\M$ in the context of a general resource theory $\R = (\F, \O)$.
	State order is covariantly preserved due to the defining property of a monotone, stated in~\cref{def:mono}, where the pre-order $\prec_{\R'}$ is simply the total order $\leq$ on $\mathbb{R}$. 
	
	Operational composition is covariantly preserved when we simply choose $\Pio(\E) = 1_\times$, namely the `multiplication by 1' operation on real numbers. 
	The definition of a resource monotone then automatically implies covariance.
	
	Conversely, given any covariant projection of $\R$ for which $\prec_{\R'}$ is a total order, we may map the totally ordered set of elements $\Pis(\rho)$ via an injective, non-decreasing function $f$ into $\mathbb{R}$. 
	Then, $\M(\rho):=f(\Pi_s(\rho))$ provides a numerical value for each $\rho$ that obeys the definition of a monotone.
	
\end{proof}

We can also view $\sigma$--fragments as an example of reducing the structure of a magic theory $\R$ to a subtheory with a tractable pre-order.
However, states which are incomparable in $\R$ remain incomparable and conversions between states which are comparable in $\R$ may no longer be possible.
\begin{definition}[\textbf{Contravariant projection}]\label{def:contraproj}
	Let $\R = (\F, \O)$ be a resource theory with pre-order $\prec_\R$. 
Then a \emph{contravariant resource projection} of $\R$ onto a resource theory $\R'$ with pre-order $\prec_{\R'}$, is a pair of mappings $(\Pi_s, \Pi_o)$, where $\Pi_s$ maps quantum states in $\R$ onto quantum states in $\R'$, and $\Pi_o$ maps free operations in $\R$ onto free operations in $\R'$. 
Moreover, these obey
	\begin{enumerate}
        \item $\rho_1 \prec_\R \rho_2$ whenever $\Pis(\rho_1) \prec_{\R'} \Pis(\rho_2)$;
        \item $\E = \E_1 \circ \E_2$ whenever $\Pio(\E) = \Pio(\E_1) \circ \Pio(\E_2)$.
    \end{enumerate}
We call $\R'$ a \emph{contravariant fragment} of $\R$.
\end{definition}
The use of covariant and contravariant in~\cref{def:covproj,def:contraproj} refers to the direction of implication between the two pre-orders and operation compositions\footnote{Note that strictly these are not projections in the sense of $\Pi^2 = \Pi$, but are instead morphisms. 
Here our use of the term projection is motivated by the idea that one one generally loses information about $\R$ under the mapping.}.

\nick{Perhaps scrap definition of contravariant projection and define contravariant fragment as a subtheory $\R'$ where there exists a (injective) covariant projection from $\R'$ to parent theory $\R$. That would make every subtheory $\R' = (\F', \O')$ a contravariant fragment if $\O'$ is closed under composition, this includes $\sigma$--fragments.}

\begin{proposition}\label{thm:subproj}
    Let $\R = (\F, \O)$ be a resource theory, and let $\O' \subseteq \O$ be a non-empty subset of the free operations that is closed under composition, and moreover $\O'$ is the largest such subset, in the sense that for any $\E_1 \not \in \O'$ and any $\E_2 \in \O'$ we have that both $\E_1 \circ \E_2$ and $\E_2 \circ \E_1$ are not in $\O'$. Then $\R' = (\F, \O')$ of $\R$ defines a contravariant fragment of $\R$.    
\end{proposition}
\begin{proof}
    We first define $\Pis (\rho) = \rho$ for all $\rho$. It is clear that since $\O'$ is a subset of $\O$ any operation in $\O'$ will map the set of free states into itself. Moreover the identity channel $id$ is necessarily in $\O'$, due to the maximality assumption. For $\Pio$ we let $\Pis(\E) = \E$ if $\E \in \O'$ and otherwise $\Pis(\E) =id$. Now consider $\Pio (\E_1 \circ \E_2)$. Either the triple $\{\E_1, \E_2, \E_1\circ \E_2\}$ are all in $\O'$ or they are all outside of $\O'$. For the former case $\Pio(\E_1 \circ \E_2) = \E_1 \circ \E_2 = \Pio(\E_1) \circ \Pio(\E_2)$, while for the latter $\Pio(\E_1 \circ \E_2) = id = \Pio(\E_1) \circ \Pio(\E_2)$, which proves that compositions are respected under the map. Finally, $\rho \prec_{R'} \sigma$ implies there exists $\E \in \O' \subseteq \O$ such that $ \E(\rho) = \sigma$, and since $\E \in \O$ this implies $\rho \prec _{\R} \sigma$, as required, which completes the proof.
    
\end{proof}
\nick{Suppose $\E_2$ is the replacement channel $\E_2(\rho) = \sigma$. This is a stabilizer operation. Then $\E_2 \circ \E_1 \in \O_\sigma$ even if $\E_1 \notin \O_\sigma$. Now suppose $\E$ is a Hadamard unitary, then $id = \E \circ \E_{reverse}$ but $id \in \O_{\ketbra{0}}$ while $\E, \E_{reverse} \notin \O_{\ketbra{0}}$.} \ddd{[Ah ok, agreed. This is fine for now. Let's not spend ages trying to generalise this so as to include the majorization fragments. It's just good to explore the possibilities a bit, to illustrate the non-trivial aspects.]}
As an immediate corollary of~\cref{thm:subproj}, a $\sigma$--fragment of any magic theory $\R$ is a contravariant fragment of $\R$.


\begin{proposition}
	Let $\R = (\F,\O)$ be a resource theory, and let $\D \in \O$ be a free operation, which is reversible by $\D_{\rm{rev}} \in \O$, so that $\D_{\rm{rev}} \circ \D = \idc$.
	
	Then, we can define a contravariant projection of $\R$, by acting on all quantum states with $\D$.
\end{proposition}
\begin{proof}
	We show that the theory $\R' = (\F', \O)$, with $\F' = \{\D(\rho):\rho \in \F \}$, is a contravariant fragment of $\R$.
	
	Let $\Pis$ map every state $\rho$ to $\D(\rho)$ and suppose $\D(\rho_1) \prec \D(\rho_2)$. 
	Then, there exists $\E \in \O$ such that $\rho_1 = (\D_{\rm{rev}} \circ \E \circ \D) (\rho_2)$, so $\rho_1 \prec \rho_2$.
	
	Finally, let $\Pio$ map every free operation to itself, so that composition of operations is trivially preserved.
	
\nick{If $\D$ is a recovery map, so that $\D \circ \D_{\rm{rev}} = \idc$, then this is a covariant projection instead.

If $\D$ is not reversible, this mapping is in general NOT contravariant (consider the replacement map $\D(\rho) = \frac{1}{d}\id$ for a strange state and stabilizer state - surely there is such a counterexample in thermodynamics theory if we consider a highly coherent state and one with the same energy population but no coherences.} \ddd{[Ok. Again, let's not spend time worrying about this now. It's clear there is various fine-print to these cases...but they're not essential to our work so let's put this on hold.]}
\end{proof}

Important examples of resource fragments appear in several established resource theories. \nick{Need to check if the thermodynamics example works, include magic theories as fragments of $\Rmax$, include Nielsen's bipartite entanglement.} \ddd{[Don't worry about these things now -- let's get the computations section improved]}

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Conclusion}
\label{sec:conc}

\begin{enumerate}
    \item Introduced fragments
    \item Identify symmetries of the setup
    \item Combined single-shot thermodynamics with magic 
    \item Can we solve other cases exactly? (apart from single qutrit)
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliography{bib}
%\bibliographystyle{apsrev4-2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\appendix
\input{appendix}

\end{document}